\documentclass[a4paper,12pt]{article}
\usepackage{latexsym}
\usepackage{array}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{bm}
\usepackage{braket}
\usepackage{subfigure}
\usepackage{color}
\usepackage{colortbl}
\usepackage{cite}
\usepackage{float}
\usepackage{eqparbox}
\usepackage{graphicx}
\usepackage{ulem}
\usepackage{booktabs}
\usepackage[Symbol]{upgreek}
\usepackage{subfigure}
\usepackage{stfloats}
\usepackage{algorithmicx,algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{threeparttable}
\usepackage{theorem}
\usepackage{times}
\usepackage{dcolumn}
\usepackage{bbm}
\usepackage{multirow}
%\usepackage[boxed]{algorithm2e}
\usepackage{framed}
\usepackage{xcolor}
\usepackage{lipsum}
\usepackage{soul}
\usepackage{mdframed}

\renewcommand{\algorithmiccomment}[1]{\hfill\eqparbox{COMMENT}{\%~#1}}

\newtheorem{theorem}{\bf Theorem}
\newtheorem{proposition}{\bf Proposition}
\newtheorem{lemma}{\bf Lemma}
\newtheorem{definition}{Definition}
\newtheorem{remark}{\bf Remark}


\setlength{\textheight}{245mm}
\setlength{\textwidth}{170mm}
\setlength{\topmargin}{-15mm}
\setlength{\oddsidemargin}{-5mm}
\setlength{\evensidemargin}{-5mm}
\flushbottom
\setlength{\parindent}{0pt}
\setlength{\baselineskip}{17pt}
\setlength{\parskip}{3mm}
\setlength{\columnsep}{8mm}
\renewcommand{\baselinestretch}{1.3}
\hyphenation{op-tical net-works semi-conduc-tor IEEEtran}
\DeclareGraphicsRule{.png}{eps}{.bb}{}
\allowdisplaybreaks[4]

\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcommand{\red}[1]{{\color{red}{#1}}}
\newcommand{\blue}[1]{{\color{blue}{#1}}}
\newcommand{\Authors}[1]{{\blue{{\textbf{Authors: }}{#1}}}}

\newenvironment{cframed}[1][blue]
  {\def\FrameCommand{\fboxsep=\FrameSep\fcolorbox{#1}{white}}%
    \MakeFramed {\advance\hsize-\width \FrameRestore}}
  {\endMakeFramed}

\newenvironment{IEEEproof}{{\it Proof. }}{}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}

\def \T {^{\mathsf{T}}}
\def \H {^{\mathsf{H}}}
\def \ri {{\rm i}}
\def \d {{\rm d}}

\def\onecol{}

\begin{document}

\begin{center}
 {\Large\bf A General DoF and Pattern Analyzing Scheme for Electromagnetic Information Theory}
\end{center}
\begin{center}
 {\Large\bf (Original paper ID: IT-25-0327)}
\end{center}
\begin{center}
 {\Large\bf Response Letter}
\end{center}
\begin{center}
Zhongzhichao Wan, {\it Student Member,~IEEE}, Jieao Zhu, {\it Student Member,~IEEE}, \\Yongli~Yan, {\it Member,~IEEE}, and Linglong Dai, {\it Fellow,~IEEE}

\end{center}
\vspace*{+2mm}
\begin{center}
 {\Large\bf Response to Editor's Comments}
\end{center}


\textbf{Editor}: Manuscript ID IT-25-0327 titled "A General DoF and Pattern Analyzing Scheme for Electromagnetic Information Theory" which you submitted to the IEEE Transactions on Information Theory, has been reviewed.  The comments of the reviewer(s) are included at the bottom of this letter. There may be additional comments as separate files available through your Author Center on the ScholarOne Manuscripts web site, so please check there also to make sure you have received all reviewer comments.

\quad Based on my own detailed reading of the paper and the reviewers’ comments, I recommend that you revise and resubmit your manuscript. Specifically, in your revision, the following points must be addressed:

\quad The reviewers appreciate the generalization of the Slepian concentration theory to 3D and 4D domains. However, based on the reviews and my own reading, there seems to be some disconnection or potentially contradictions in the nature of the work that needs to be clarified or resolved. One of the main claims is the non-asymptotic analysis and as one reviewer has mentioned, to obtain the results, asymptotic analysis is needed. In that case, the justification for DoF analysis when capacity is understood is unclear. There are additional valuable comments from the reviewers.


\blue{
    {\bf Authors:}
    We would like to commence by thanking the editor and three professional reviewers for their valuable time in evaluating our submission. Your constructive comments and expert knowledge of the field have helped us to strengthen the manuscript significantly. We endeavored to address all the suggestions and comments, and our reflections are provided below in a point-to-point manner. We also indicate how our manuscript has been revised accordingly, and all the revisions have been highlighted in \red{red} color in the revised paper. Here, we would like to make a brief summary of the major revisions in the revised paper as below:
    \begin{enumerate}
    	\item a
%        \item To answer the relationship of our work with respect to existing works and show the novelty of our work, we have reorganized the contribution part in the Introduction section. 
%        \item To make the model more solid and persuasive, we have added explanations about the assumptions and simplifications used in the modeling part. We also show that some simplifications have already been adopted in existing papers.
%        \item To show the fitness of the model to practical scenarios, we have generated a channel based on Hong Kong streets using ray tracing, and then show the fitness of our model to it. 
%        \item We have also modified or rewritten several parts and added explanations to improve the readability of our paper.
    \end{enumerate}
}


{\bf Editor:} My own comments:

\quad As always the submission of the revised manuscript should be accompanied by a detailed response to the reviewers’ and to my comments.  In preparing this response, please pay particular attention to the points mentioned above.

\quad Once the revised manuscript is prepared, you can upload it and submit it through your Author Center.


\blue{
    {\bf Authors}:
    Many thanks again for Editor's and all the Reviewer's valuable time and efforts to review this paper. Based on your constructive comments, we have already made a careful major revision of this paper, which is attached to the end of this letter. 
    \\
    \\
    Sincerely, 

    {\it The Authors}
}

\clearpage


\begin{center}
    {\Large\bf Response to Reviewer 1's Comments}
\end{center}

{\textbf{Reviewer 1:}}
This paper provides a general scheme, where tools from Slepian concentration problem are used and extended to 3-dim space domain and 4-dim space-time domain, to analyze the (functional and channel) DoF of electromagnetic fields.

\quad I am not familiar with the subject of electromagnetic information theory, thus, I can only provide some minor comments.

{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's positive evaluations of our work. We have tried our best to revise the paper according to the reviewer's valuable comments, and our responses are provided in a point-to-point manner as below. 
}}

\textbf{Reviewer 1:}
1. In page 5, the last line above Eq. (3), the idea is perfectly fine but maybe it is a typo? From my limited understanding, for bandlimited functions, the $\lambda$ to be maximized should be
$\frac{\int_{-T}^T|g(t)|^2dt}{\int_{-\infty}^\infty|g(t)|^2dt}$?


{\color{blue}{\textbf{Authors: } 
Many thanks for the reviewer's valuable comment. $\{\lambda\}$ can be obtained both from time and frequency domain. The results will be the same. This phenomenon is ensured by Theorem 1 in the paper which comes from [26]. To be more straightforward, it shows some kind of "symmetry" on the two domains when finding the "most concentrated functions". In Eq. (3) we choose to have band-limitation in time domain (in another word we can say we observe the signal on a given time interval) and express $\lambda$ using frequency domain. The inverse procedure also exists and will lead to the same result. According to your comment, we have added more explanations in the paper. 

\quad Detailed revisions are shown in the following box:

}}
\begin{framed}
    {\bf Section III.A}

\setcounter{equation}{0}

Moreover, nearly all eigenvalues on the right side of the transition line tends to 0. Therefore, $N^{1D}$ is the asymptotic DoF of the signal space when $\Omega T \rightarrow \infty$. {\color{red}It is worth noting that we can find the ``optimally concentrated signal" both from time and frequency domains, and the eigenvalue $\lambda$ will be the same. When beginning from $g(t) = (2\pi)^{-1}\int_{-\Omega}^{\Omega}G(\omega)e^{{\rm j}\omega t} {\rm d}\omega$, we have $\lambda = \frac{\int_{-T}^{T}|g(t)|^2{\rm d}t}{\int_{-\infty}^{\infty}|g(t)|^2{\rm d}t}$. Then we have 
	\begin{equation}
		\begin{aligned}
			\int_{-\Omega}^{\Omega}D(\omega,\omega')G_i(\omega'){\rm d}\omega' = \lambda_i G_i(\omega),
		\end{aligned}
		\label{eqn_1d_omega}
	\end{equation}
	and
	\begin{equation}
		\begin{aligned}
			D(\omega,\omega') = (2\pi)^{-1}\int_{-T}^T e^{-{\rm j}t(\omega-\omega')}{\rm d}t = \frac{\sin(T(\omega-\omega'))}{\pi(\omega-\omega')}.
		\end{aligned}
	\end{equation}
	It is easy to verify that the eigenvalues in (18) and (21) are the same.
}

    
\end{framed}



\textbf{Reviewer 1:}
2. In page 9, the 4th line below Eq. (26), it should be “importance” instead of ”importance”.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer for pointing out this problem. We have corrected this issue, the detailed revisions are shown in the following box.
}}

\begin{framed}
	{\bf Section III.C}

  By solving this integral equation we obtain the eigenvalues that determine the number of base functions required to construct the received electric field, which can be viewed as the dimension of the subspace constructed by the possible received electric field. To be more specific, the eigenvalues determine the {\color{red}``importance"} of the eigenfunctions as bases of the electromagnetic fields which satisfy the concentration conditions.

\end{framed}

\textbf{Reviewer 1:}
3. It is better to have some references for the last sentence of page 9. 

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable suggestions. We have added references that have restrictions on the wavenumber domain, which constraint the direction of the incident wave to the receiver. Such constraints affect the channel model and DoF analyzing results. Detailed revisions are shown in the following box.
}}

\begin{framed}
	{\bf Section III.C}
	
	In the above part we are analyzing the scenario where the direction of ${\bf k}$ is not restricted, which means that the incident wave to the receiver may have arbitrary direction, corresponding to general channel settings. Given a specific channel, the direction of the incident wave to the receiver may be constrained, which adds further restrictions on ${\bf k}$.  Specifically, new constraints ${\Omega}_1 \subset {\Omega}=\{\hat{\bf k}: \left\| \hat{\bf k} \right\|=1\}$ on $\hat{\bf k}$ can be introduced, which is determined by the concentration region of the electromagnetic field caused by the scattering channel. {\color{red} The restrictions on $k$ have been used in channel modeling schemes [47], as a tool to depict the wavenumber domain characteristics caused by the scatterers.
		It has also been used for DoF analysis [26], where asymptotic conclusions about the channel DoF are obtained based on one-dimensional Slepian concentration problem. } 
  
\end{framed}

{\color{blue}
	{\bf References:}
	
	[26] A. S. Poon, R. W. Brodersen, and D. N. Tse, “Degrees of freedom in multiple-antenna channels: A signal space approach,” {\it IEEE Trans. Inf. Theory}, vol. 51, no. 2, pp. 523–536, Feb. 2005.

[47] A. Pizzo, L. Sanguinetti, and T. L. Marzetta, “Fourier plane-wave series expansion for holographic MIMO communications,” {\it IEEE Wireless Commun.}, vol. 21, no. 9, pp. 6890–6905, Sep. 2022.
}

{\color{blue} \textbf{Authors}: Thank you for your valuable time and efforts to review this paper. Your comments and suggestions have helped us improve our work.
	\\
	\\
	Sincerely,
	
	{\it The Authors}
}


\clearpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{center}
    {\Large\bf Response to Reviewer 2's Comments}
\end{center}

\textbf{Reviewer 2:}
The paper focuses on the DoF for electromagnetic information theory under a non-asymptotic setting, i.e., finite spatial regions and finite frequency bandwidth. Building upon the Slepian concentration problem in one and two-dimensional domains, the asymptotic DoF in the three-dimensional space domain and the four-dimensional space-time domain under electromagnetic constraints is analyzed. Most importantly, it was proved that the channel DoF is upper bounded by the functional DoF of electromagnetic fields under a maximum error constraint. Numerical results show the impacts of the constraints on the space and wavenumber domains on the DoF. The reviewer appreciates the efforts that have been made to characterize the DoF of electromagnetic fields in a larger domain. However, the analysis is limited to the asymptotic case as it still requires the product of those domains to go to infinity to achieve the maximum DoF. In contrast, the non-asymptotic case is discussed in the numerical results only. In terms of the writing, the first half of the paper lacks a connection to information theory. The reviewer feels that the paper may be more suitable for journals like TCOM or TWC rather than T-IT. The detailed comments and suggestions are as follows.


{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's positive evaluations on our work. We have tried our best to revise the paper according to the reviewer's valuable comments, and our responses are provided in a point-to-point manner as below. 
}}


\textbf{Reviewer 2:}
1. As the authors pointed out, the capacity analysis of EIT has already been available in the literature. What is the motivation for studying the DoF? Isn’t the DoF a more restricted result compared to the capacity or mutual information analysis?

{\color{blue}{\textbf{Authors: } 
 Thanks to the reviewer's valuable comments. The motivation of studying the DoF can be presented from the following two perspectives: 1) The degrees of freedom (DoF) of an electromagnetic field characterize the dimension of the functional space it spans, i.e., the minimum number of orthogonal base functions required for its representation. Compared to mutual information or capacity analysis, the DoF analyzing framework offers a more fundamental and physically intuitive criterion for determining the number of antennas required in array design to approach optimal system performance. 2) While capacity and mutual information analysis in existing works rely on a specific channel model, in this paper the fDoF analysis is an upperbound covering all kinds of channel conditions, which only relies on the characteristics of the transceivers and is different from the results obtained from capacity or mutual information analysis. We have also discussed the relationship between fDoF and cDoF which relies on a specific channel. Therefore, our analysis about DoF has provided some new insights compared to existing capacity or mutual information analysis.  
 
 
  According to the reviewer's comments, we have added clarifications and explanations about the necessity of analyzing the DoF. The detailed revisions are shown in the following box:
}}

\begin{framed}
    {\bf Section I}

	\setcounter{equation}{0}
	
\quad The existing research directions of EIT includes channel modeling schemes [11]-[13], DoF analysis [14]-[16], mutual information and capacity analysis [17]-[19], etc.
Among these directions, DoF analysis is one of the most important parts, since it provides the upper bound of usable data streams and shows the required number of antennas, which guides the design of practical antenna arrays. {\color{red}To be more specific, the DoF of an electromagnetic field characterizes the dimension of the functional space it spans, i.e., the minimum number of orthogonal base functions required for its representation. Compared to mutual information or capacity analysis, the DoF analyzing framework offers a more fundamental and physically intuitive criterion for determining the number of antennas required in array design to approach optimal system performance. }

{\bf Section II}

	{\bf \color{red} {\it \bf E.} Relationship between DoF, mutual information and capacity for EIT}
	
	{\color{red}
	
	\quad In the previous part, we have provided mathematical definitions about the functional DoF of electromagnetic fields (fDoF) and the channel DoF which further considers channel conditions between the transceivers (cDoF). Moreover, we have provided the analysis of the relationship between fDoF and cDoF. In this part, we will have some discussions about the relationship between the defined DoF and other concepts like mutual information and capacity, which have already been widely discussed in the research field of EIT.
	
	\quad As shown in Sec. II-D, the proposed fDoF provides an upperbound for all kinds of channel conditions. Therefore, we can design the deployment strategies of transceivers based on the obtained fDoF, which has the maximum redundancy. To be more specific, no matter how the channel condition changes, the designed system can capture all the possible DoF in the system. The relationship between fDoF and cDoF is explained in {\bf Theorem} 1. When considering a specific channel, cDoF can be used and has a deep connection to the mutual information and capacity. In [19] we have expressed the mutual information between random electromagnetic fields as $I(E;Y) = \sum_i{\rm log}(1+\frac{\lambda_i}{\sigma^2})$ based on Mercer' s theorem [28]. It can be observed that the mutual information can be expressed as the summation of infinite terms derived from the statistical characteristics of the received fields, which are determined by the channel. Each item in the expression of mutual information corresponds to one degree of freedom, where different $\lambda$ reflecting the criticality weight of the corresponding sub-channel, as discussed in Definition 2.
	
	\quad When further considering channel capacity, we shall fix the field distribution which maximizes the mutual information to obtain the capacity based on continuous electromagnetic fields and channels. This procedure is an extension from the discrete matrices to continuous operators, represented as $P$ in Definition 2. For discrete matrices we have $C = \underset{K_J}{\rm max}{\rm logdet}\frac{HK_JH^{\rm H}+K_N}{K_N}$ with respect to ${\rm Tr}(K_J) \leqslant P$. By using singular value decomposition and Karush–Kuhn–Tucker (KKT) theorem, we can obtain the maximum mutual information which is the capacity. For operators, the optimization problem can be solved by the extended KKT theorem [29] for countably infinite variables. The result is in the form of the water-filling method, where the insignificant subchannels are discarded, leaving only the channels corresponding to large eigenvalues. This procedure is the same as what we have done in the definition of DoF. 
	
	\quad In all, the proposed fDoF has and indirect relation with mutual information and capacity, which is established by cDoF. Besides, all these concepts used in EIT are based on continuous electromagnetic fields which are in spaces with infinite dimensions. This property, distinct from finite-dimensional matrices, entails the necessity of filtering out insignificant basis functions or subchannels based on the error tolerance threshold $\epsilon$. 
	
}

\end{framed}

{\color{blue}
	{\bf References:}
	
	[19] Z. Wan, J. Zhu, Z. Zhang, L. Dai, and C.-B. Chae, “Mutual information for electromagnetic information theory based on random fields,” {\it IEEE Trans. Commun.}, vol. 71, no. 4, pp. 1982–1996, Feb. 2023.
	
	[28] J. Mercer, “Functions of positive and negative type, and their connection with the theory of integral equations,” {\it Philos. Trans. Roy. Soc. London}, vol. 209, no. 441-458, pp. 415–446, Jan. 1909.
	
	[29] M. Bachir, A. Fabre, and S. Tapia-Garcia, “Finitely determined functions,” {\it Advances in Operator Theory}, vol. 6, no. 2, pp. 1–24, 2021.
}

\textbf{Reviewer 2:}
2. Upon reading half of the paper, it seems that the connection between the presented materials and information theory is lacking. The reviewer suggests reorganizing the paper and introducing relevant background on EIT or channel model, problem formulation, etc., in Section II first. For example, the authors could clarify the relation between the DoF and capacity in EIT.

{\color{blue}{\textbf{Authors: } 
Many thanks for the reviewer's valuable comment. We deeply agree with the reviewer that the paper needs to be reorganized. 
We have reversed {\bf Section II} and {\bf Section III} in the original paper, which means that the problem formulation and DoF definition parts are introduced before Slepian concentration problem. 

We have also added a new subsection as {\bf Section II.A} which formulates the basic electromagnetic model for EIT according to the suggestion of the reviewer. This subsection helps strengthen the background and channel model for EIT, and shows the physical restrictions on the electromagnetic field, which will be used when analyzing the DoF.

For the relation between the DoF and capacity in EIT, we have added a new subsection as {\bf Section II.E}, which clarifies the relation between the DoF and capacity in EIT.

\quad Detailed revisions are shown in the following box:

}}
\begin{framed}
	{\bf Section II. {\color{red} Basic electromagnetic model and DoF definition for EIT}}
	
	{\color{red} 
	\quad	In this section we will first introduce the basic model of EIT from the electromagnetic perspective. Based on the electromagnetic model we will show the physical constraints of the transceivers, which motivates the analysis of DoF upperbound of a wireless communication system. Then we will provide mathematical definitions for the DoF of electromagnetic fields. We will discuss the DoF of electromagnetic fields and the DoF considering channel conditions separately, and then provide a theorem showing the relationship between them. Finally, we will discuss the relationship between DoF, mutual information, and capacity, which shows how our research result in this paper is related to other works in the research field of electromagnetic information theory.
	}

	\setcounter{equation}{0}
	
	{\bf {\color{red}A. Electromagnetic model}}
	
	{\color{red}
	\quad In this part, we will introduce the electromagnetic laws, which are the basic constraints for wireless communication systems. Maxwell's equations, which depict how electric and magnetic fields are generated by charges, currents, and changes of the fields, are shown as follows [24]
	
	\begin{subequations}
		\begin{align} 
			& \nabla \cdot  (\epsilon({\bf r}) {\bf E}({\bf r},t)) = \rho({\bf r},t), \label{eqn_1a}\\
			& \nabla \cdot (\mu({\bf r}) {\bf H}({\bf r},t)) = 0,\\
			&\nabla \times {\bf E}({\bf r},t) = -\frac{\partial \mu({\bf r}) {\bf H}({\bf r},t)}{\partial t}, \label{eqn_1c}\\
			& \nabla \times {\bf H}({\bf r},t) = \frac{ \partial \epsilon({\bf r}) {\bf E}({\bf r},t)}{\partial t}+{\bf J}({\bf r},t) \label{eqn_1d}, 
		\end{align}
	\end{subequations}
	
	\quad When considering electromagnetic wave propagation in free space, we can assume that $\epsilon({\bf r}) = \epsilon_0$ and $\mu({\bf r}) = \mu_0$ are constant parameters as in vacuum. Then we have
	\begin{subequations}
		\begin{align} 
			& \nabla \cdot  {\bf E}({\bf r},t) = \frac{\rho({\bf r},t)}{\epsilon_0}, \label{eqn_2a}\\
			& \nabla \cdot {\bf H}({\bf r},t) = 0,\\
			&\nabla \times {\bf E}({\bf r},t) = -\frac{\partial \mu_0 {\bf H}({\bf r},t)}{\partial t}, \label{eqn_2c}\\
			& \nabla \times {\bf H}({\bf r},t) = \frac{ \partial \epsilon_0 {\bf E}({\bf r},t)}{\partial t}+{\bf J}({\bf r},t) \label{eqn_2d}, 
		\end{align}
		\label{eqn_2}
	\end{subequations}
	If we further assume a source-free region, we have $\rho$ and ${\bf J}$ equal to 0. Then by performing $\nabla\times $ on (\ref{eqn_2c}), substituting it into (\ref{eqn_2d}), applying (\ref{eqn_2a}), and using the identity $\nabla\times(\nabla\times {\bf E}) = \nabla(\nabla\cdot {\bf E})-\nabla^2 {\bf E}$, we can arrive at
	\begin{equation}
		\begin{aligned}
			\nabla^2 {\bf E}({\bf r},t) - \epsilon_0 \mu_0 \frac{\partial^2 {\bf E}({\bf r},t)}{\partial t^2} = 0. 
		\end{aligned}
		\label{eqn_wave_equation_with_no_source}
	\end{equation}
	By substituting plane wave form ${\bf E}({\bf r},t) = {\bf E}_0 e^{{\rm j}({\bf k}\cdot {\bf r}-\omega t)}$ into the wave equation (\ref{eqn_wave_equation_with_no_source}), we can arrive at
	\begin{equation}
		\left\|  {\bf k} \right\|^2 = k^2 = \epsilon_0 \mu_0 \omega^2 = \frac{\omega^2}{c^2},
		\label{eqn_dispersion_relation}
	\end{equation}
	which is the dispersion relation of electromagnetic fields in free space. An intuitive interpretation of this relation is that electromagnetic waves experience $\frac{|\omega|}{2\pi}$ circles in unit time and $\frac{|k|}{2\pi}$ circles traveling in unit length. Since electromagnetic waves travel in light speed $c$ in vacuum, we can directly obtain the dispersion relation.
	
	\quad We can also view the dispersion relation from the Green's function perspective. Consider two arbitrary regions $V_{\rm s}$ and $V_{\rm r}$ as the source and the destination for wireless communications. The Green's function ${\bf{G}} ({\bf{r}},{\bf{s}})\in \mathbb{C}^{3\times 3}$ is introduced to solve the vector wave equation. Consider the electromagnetic wave on a given frequency point $\omega$ (time-harmonic) [25], the whole electromagnetic field can be viewed as the superposition of the single-frequency waves at all possible frequency points. Then we arrive at the vector wave equation from (\ref{eqn_2}) as follows
	\begin{equation}
		\nabla  \times \nabla  \times {\bf{E}}\left( {\bf{r}} \right) - {\omega ^2 \mu_0 \epsilon_0}{\bf{E}}\left( {\bf{r}} \right) = {\rm j}\omega {\mu _0}{\bf{J}}\left( {\bf{r}} \right).
		\label{VWE}
	\end{equation}
	From the linearity nature of (\ref{VWE}), the Green's function is introduced to solve the vector wave equation and derive the input-output relationship of wireless communication system enabled by electromagnetism. 
	Utilizing the Green's function, the electric field ${\bf{E}}({\bf{r}})$ can be expressed by  
	\begin{equation}
		{\bf{E}}({\bf{r}}) = \int_{{V_s}} {\bf{G}} ({\bf{r}},{\bf{s}}){\bf{J}}({\bf{s}}){\rm d}{\bf{s}},\quad {\bf{r}} \in {V_r},
		\label{VWE_Green}
	\end{equation}
	where the Green's function obeys the following equation
	\begin{equation}
		\nabla_{\bf r}  \times \nabla_{\bf r}  \times {\bf{G}}\left( {\bf{r}},{\bf {s}} \right) - {\omega ^2 \mu_0 \epsilon_0}{\bf{G}}\left( {\bf{r}},{\bf {s}} \right) = {\rm j}\omega {\mu _0}\delta\left( {\bf{r}}-{\bf {s}} \right).
		\label{VWE_Green_1}
	\end{equation}
	By performing Fourier transform on both sides of (\ref{VWE_Green_1})\cite{poon2005degrees}, we can obtain the Green's function expressed in the wavenumber domain as 
	\begin{equation}
		{\bf G}({\bf k},{\bf s}) = \frac{{\rm j}\omega\mu_0 e^{-{\rm j}{\bf k}\cdot {\bf s}}}{k^2-\omega^2/c^2}\left({\bf I} - \hat{\bf k}\hat{\bf k}^{\rm T}  \right),
		\label{eqn_G_in_wavenumber_form}
	\end{equation}
	where $\hat{\bf k} = {\bf k}/k$.
	
	\quad From (\ref{eqn_G_in_wavenumber_form}) we can find that there are poles at $k^2 = \omega^2/c^2$ in the wavenumber domain (Fourier transform of space domain) expression of Green's function, which means that the components at $k^2 = \omega^2/c^2$ can spread far away and other components will decay with distance. Therefore, in the wireless communication system with large distances between transceivers, we can use $k^2 = \omega^2/c^2$ as a basic physical constraint for the electromagnetic waves. 
	
	
}

{\bf \color{red} {\it \bf E.} Relationship between DoF, mutual information and capacity for EIT}

{\color{red}
	
	\quad In the previous part, we have provided mathematical definitions about the functional DoF of electromagnetic fields (fDoF) and the channel DoF which further considers channel conditions between the transceivers (cDoF). Moreover, we have provided the analysis of the relationship between fDoF and cDoF. In this part, we will have some discussions about the relationship between the defined DoF and other concepts like mutual information and capacity, which have already been widely discussed in the research field of EIT.
	
	\quad As shown in Sec. II-D, the proposed fDoF provides an upperbound for all kinds of channel conditions. Therefore, we can design the deployment strategies of transceivers based on the obtained fDoF, which has the maximum redundancy. To be more specific, no matter how the channel condition changes, the designed system can capture all the possible DoF in the system. The relationship between fDoF and cDoF is explained in {\bf Theorem} 1. When considering a specific channel, cDoF can be used and has a deep connection to the mutual information and capacity. In [19] we have expressed the mutual information between random electromagnetic fields as $I(E;Y) = \sum_i{\rm log}(1+\frac{\lambda_i}{\sigma^2})$ based on Mercer' s theorem [28]. It can be observed that the mutual information can be expressed as the summation of infinite terms derived from the statistical characteristics of the received fields, which are determined by the channel. Each item in the expression of mutual information corresponds to one degree of freedom, where different $\lambda$ reflecting the criticality weight of the corresponding sub-channel, as discussed in Definition 2.
	
	\quad When further considering channel capacity, we shall fix the field distribution which maximizes the mutual information to obtain the capacity based on continuous electromagnetic fields and channels. This procedure is an extension from the discrete matrices to continuous operators, represented as $P$ in Definition 2. For discrete matrices we have $C = \underset{K_J}{\rm max}{\rm logdet}\frac{HK_JH^{\rm H}+K_N}{K_N}$ with respect to ${\rm Tr}(K_J) \leqslant P$. By using singular value decomposition and Karush–Kuhn–Tucker (KKT) theorem, we can obtain the maximum mutual information which is the capacity. For operators, the optimization problem can be solved by the extended KKT theorem [29] for countably infinite variables. The result is in the form of the water-filling method, where the insignificant subchannels are discarded, leaving only the channels corresponding to large eigenvalues. This procedure is the same as what we have done in the definition of DoF. 
	
	\quad In all, the proposed fDoF has and indirect relation with mutual information and capacity, which is established by cDoF. Besides, all these concepts used in EIT are based on continuous electromagnetic fields which are in spaces with infinite dimensions. This property, distinct from finite-dimensional matrices, entails the necessity of filtering out insignificant basis functions or subchannels based on the error tolerance threshold $\epsilon$. 
	
}

    
\end{framed}

{\color{blue}
	{\bf References:}
	
	[19] Z. Wan, J. Zhu, Z. Zhang, L. Dai, and C.-B. Chae, “Mutual information for electromagnetic information theory based on random fields,” {\it IEEE Trans. Commun.}, vol. 71, no. 4, pp. 1982–1996, Feb. 2023.
	
	[24] D. J. Griffiths, Introduction to Electrodynamics. American Association of Physics Teachers, 2005.
	
	[25] F. K. Gruber and E. A. Marengo, “New aspects of electromagnetic information theory for wireless and antenna systems,” {\it IEEE Trans. Antennas Propag.}, vol. 56, no. 11, pp. 3470–3484, Nov. 2008.
	
	[28] J. Mercer, “Functions of positive and negative type, and their connection with the theory of integral equations,” {\it Philos. Trans. Roy. Soc. London}, vol. 209, no. 441-458, pp. 415–446, Jan. 1909.
	
	[29] M. Bachir, A. Fabre, and S. Tapia-Garcia, “Finitely determined functions,” {\it Advances in Operator Theory}, vol. 6, no. 2, pp. 1–24, 2021.
}

\textbf{Reviewer 2:}
3. Please provide a precise mathematical definition for DoF and orthogonal patterns for the electromagnetic fields at the beginning.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable comment. We have reversed {\bf Section II} and {\bf Section III}. Then we put the mathematical definition for DoF of electromagnetic fields in {\bf Section II.B} and {\bf Section II.C} as {\bf Definition 1} and {\bf Definition 2}. In {\bf Section II}, the orthogonal basis refers to any electromagnetic field modes that satisfy {\bf Definition 1} and {\bf Definition 2}. In {\bf Section III}, this basis will be further specialized to the eigenfunctions obtained from the Slepian concentration problem.

\quad Detailed revisions are shown in the following box:
}}

\begin{framed}
	{\bf Section II}

    {\color{red}
    	{\bf{B. DoF of electromagnetic fields}}
    	
    	\quad As is shown in (\ref{eqn_dispersion_relation}), there are some physical restrictions that the electromagnetic fields should obey in wireless communication systems. These restrictions relate to time, frequency, space, and wavenumber domain. All possible electromagnetic fields considering these restrictions span a Hilbert space whose dimension is the number of basis needed to express an arbitrary field in the space. 
    	
    	\quad Note that, unlike a discrete matrix, the dimension of a continuous Hilbert space may be infinite. However, in practical communication tasks, using an infinite number of base functions, which corresponds to infinite electromagnetic modes, is impossible and often unnecessary. The reason is that only a few base functions contribute a lot to the field reconstruction, while the remained base functions can be discarded with small loss of precision. We will give a mathematical definition of the DoF based on the above discussion and verify its rationale in the following sections of the paper. 
    }
    
    \begin{definition}
    	\label{def_fDoF}
    	(functional DoF) Let $\mathcal{H}$ be a Hilbert space and $\{f_i\}_{i=1}^n \in \mathcal{H}$ be a set of orthogonal base functions. If for arbitrary function $f \in \mathcal{H}$ that satisfies $\left\| f \right\|=1$, there always exists a set of numbers $a_i$ that 
    	$\left\| f-\sum_{i=1}^n a_i f_i  \right\| \leqslant \epsilon$. The minimum $n$ that satisfies the above conditions is the functional DoF of $\mathcal{H}$ with error $\epsilon$, i.e.,
    	\begin{equation}
    		\mathsf{fDoF}_{\epsilon} (\mathcal{H}) = {\rm min}\{ n: \underset{\mathcal{H}_n \subset \mathcal{H}}{\rm inf} \sup_{f: \left\| f \right\|=1} \inf_{g \in \mathcal{H}_n} \left\| f-g \right\| \leqslant \epsilon  \},
    	\end{equation}
    	where $\mathcal{H}_n$ is an $n$-dimensional subspace of $\mathcal{H}$.
    \end{definition}
    
    {\color{red}
    	{\bf{C. DoF of electromagnetic fields considering channel condition}}
    	
    	\quad In this part we will further provide the definition of the DoF of continuous electromagnetic fields considering a specific channel as follows
    }
    \begin{definition}
    	\label{def_cDoF}
    	(channel DoF) Let $\mathcal{H}_{\rm t}$ and $\mathcal{H}_{\rm r}$ be two Hilbert spaces and $P:\mathcal{H}_{\rm t} \rightarrow \mathcal{H}_{\rm r}$ be an operator. Let $\{g_i\}_{i=1}^{+\infty}$ and $\{f_i\}_{i=1}^{+\infty}$ be a set of orthogonal bases for $\mathcal{H}_{\rm t}$ and $\mathcal{H}_{\rm r}$ separately. Let $\{P_i\}_{i=1}^n: \mathcal{H}_{\rm t} \rightarrow \mathcal{H}_{\rm r}$ be a set of rank-1 operators. 
    	If for arbitrary $g \in \mathcal{H}_{\rm t}$ that satisfies $\left\| g \right\|=1$, there always exists a set of numbers $b_i$ that satisfies $\left\| Pg-\sum_{i=1}^{n} b_iP_ig  \right\| \leqslant \epsilon$. The minimum $n$ that satisfies the above conditions is the channel DoF of the operator $P: \mathcal{H}_{\rm t} \rightarrow \mathcal{H}_{\rm r}$ with error $\epsilon$, i.e., 
    	\begin{equation}
    		\begin{aligned}
    			\mathsf{cDoF}_{\epsilon} (\mathcal{H}_{\rm t},\mathcal{H}_{\rm r},P) =& {\rm min}\{ n: \underset{\{P_i\}_{i=1}^n: \mathcal{H}_{\rm t} \rightarrow \mathcal{H}_{\rm r}}{\rm inf} \sup_{g: \left\| g \right\|=1} \inf_{\{b_i\}_{i=1}^n} \left\| Pg-\sum_{i=1}^{n} b_iP_ig  \right\| \leqslant \epsilon  \}.
    		\end{aligned}
    	\end{equation}
    \end{definition}

\end{framed}

\textbf{Reviewer 2:}
4. A handful of notations have not been clearly defined. For example,

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer for pointing out this problem. The detailed examples are not correctly shown in the system. We have rechecked the notations in the paper and added a series of notations in the Notation part in {\bf Section I}.

 Detailed revisions are shown as in the following box: 
}}
\begin{framed}
    {\bf Section I}

    {\it B. Notation}
    
    \quad Bold uppercase characters {\color{red}${\bf H}$} denote matrices;
    bold lowercase characters {\color{red}${\bf k}$} denote vectors, {\color{red} $\left\| {\bf k} \right\|$ denotes the norm of the vector, and $\hat{\bf k}$ denote the direction of the vector};
    the dot $\cdot$ denotes the scalar product of two vectors, or the matrix-vector multiplication; {\color{red} ${\rm Tr(\cdot)}$ is the trace of a matrix, and ${\rm det}(\cdot)$ is the determinant of a matrix; $(\cdot)^{\rm T}$ is the transpose of a vector or a matrix, $(\cdot)^{\rm H}$ is the conjugate transpose of a vector or a matrix, and $(\cdot)^{*}$ is the conjugate of a number, a vector or a matrix; $|\cdot|$ is the absolute value of a number; $\nabla$ is the nabla operator, and $\nabla \times$ is the curl operator; $f(x)|_a^b$ is $f(b)-f(a)$;}
    $c$ is the speed of light in a vacuum{\color{red}, $\epsilon_0$ is the permittivity of a vacuum, $\mu_0$ is the permeability of a vacuum, $\omega$ is the angular frequency, and ${\bf k}$ is the wavenumber vector; $\underset{x \in S}{\rm sup}f(x)$ is the supremum of $f(x)$ over $x\in S$, and $\underset{x \in S}{\rm inf}f(x)$ is the infimum of $f(x)$ over $x\in S$;} 
    $\mathscr{F}[f(x)]$ denotes the Fourier transform of $f(x)$; 
    $J_m(x)$ is the $m_{\rm th}$ order Bessel function of the first kind; 
    The inner product of $f: \mathbb{R}^n \rightarrow \mathbb{C}$ and $f_i: \mathbb{R}^n \rightarrow \mathbb{C}$ on the domain $\mathcal{A}$ is denoted by $\langle f \ket{f_i}:= \int_{\mathcal{A}} f({\bf x}) f_i^*({\bf x}) {\rm d}^n{\bf x}$. The norm of $f$ is denoted by $\left\| f \right\|:=(\langle f \ket{f})^{1/2} $; {\color{red}$\mathbb{Z}^+$ refers to the set of all positive integers, and $\mathbb{R}^{n}$ refers to an 
    	$n$-dimensional vector space over the real numbers}. 
\end{framed}


\textbf{Reviewer 2:}
5. Although the authors introduce constraints in space and wavenumber domains,  it requires the product of those domains to tend to infinity to achieve the maximum DoF. The review understands that deriving the non-asymptotic DoF is difficult. But isn’t that the non-asymptotic case can be analyzed using the mutual information as in the authors’ previous works, e.g., [19]?

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's constructive comment. We have some theoretical derivations about the non-asymptotic case in the paper, which lead to the integral equations whose solutions (eigenvalues) determine the DoF (The kernel functions of the integral equations are represented as $D({\bf x},{\bf x}')$ in the paper). However, it is very difficult to provide analytical solutions for these equations. So finally we choose numerical schemes to show some results of the DoF of electromagnetic fields. We appreciate the reviewers for reading our previous paper which analyzes the mutual information under non-asymptotic cases. In that paper we have provided analytical expressions under some special cases (stationary random field with rational spectrum). However, for general cases we still use the Fredholm determinant and rely on numerical calculation schemes.

To better explain this problem and strengthen the theoretical part of the paper according to the reviewer's suggestions, we have revised the paper from the following perspectives:

1. We have added a new subsection as {\bf Section III.A} which clarifies the existing works on Slepian concentration problem, which shows the difficulties of providing analytical solutions when analyzing the scenario in spaces with dimension higher than 1.

2. We have added some qualitative and quantitative analysis about the solutions of the derived integral equations in {\bf Section III.C}, which provides some theoretical insights about the DoF in non-asymptotic cases.

3. We have added a comment about the relationship between asymptotic DoF and non-asymptotic DoF.

The detailed revisions are shown in the following box

}}

\begin{framed}
	{\bf Section III}
	
	{\bf {\color{red} A. A brief introduction of the existing works on Slepian concentration problem}}

   	{\color{red}
   	\quad The original work, accomplished by Slepian, analyzed the one-dimensional time-frequency concentration problem which has analytical solutions for the eigenvalues and eigenfunctions [30]. Based on these analytical solutions, the number of large eigenvalues and the behavior of the decay rate of small eigenvalues can be directly analyzed. The results about the one-dimensional Slepian concentration problem serve as powerful tools, which have been widely adopted in many areas, including spectrum estimation [31], capacity analysis [32], numerical integration [33], uncertainty relations [34], etc.
   	
   	\quad Slepian has also discussed the possible extension of the concentration problem to high dimensions with sphere-shaped concentration region [35], but provided no analytical solutions for the eigenvalues. Many researchers have followed his work, analyzing the Slepian concentration problem with different domain representations and concentration regions. Due to the high complexity of the high-dimensional structures, even for highly symmetric models, the existing works still focus on numerical calculation schemes instead of finding analytical solutions for the eigenvalue and eigenfunction solutions. 
   	
   	\quad For the domain representation, one approach is constraining one domain on a sphere and the other domain using degrees and orders of spherical harmonic functions. An early work considering both asymptotic results and numerical calculations in non-asymptotic scenarios has been discussed in [36]. Further works added colatitude–longitude spatial region constraints on the sphere and provided numerical calculation schemes for the eigen-problem [37]. Since our DoF analysis is with the physical constraints in space-wavenumber domains, the constraints based on spherical harmonic functions do not well fit our needs. 
   	
   	\quad Another approach is directly considering two domains that are the Fourier transform or the inverse Fourier transform of each other. By directly performing sampling on the constraint regions, [38] considered the two-dimensional Slepian concentration problem with a disc-shaped constraint region in one domain and a rectangle-shaped region in the other domain. In a similar form, [39] considered disc-shaped constraint regions in both two domains. 
   	The fast-converging numerical calculation scheme for evaluating the two-dimensional Slepian concentration problem was analyzed in [40], which considered disc-shaped constraints in two domains that are Fourier transform or inverse Fourier transform of each other. 
   	Its further extension to higher dimensional balls was shown in [41], which also considered numerical schemes and had no analytical solutions. Moreover, these two papers considered an ideal case when the concentration regions in the two domains are both $n$-dimensional balls, while our concentration region in the space domain may not always have spherical symmetry. 
   	
   	\quad Compared to these existing mathematical works, in this paper, we will formulate the Slepian concentration problem in the three-dimensional space-wavenumber domain and the four-dimensional domain which also includes time-frequency. We will obtain the concentration region in the wavenumber domain based on physical constraints like the dispersion relation. Compared to spherical regions, we mainly focus on a cuboid-shaped spatial concentration region that fits transceivers in reality better, which will break the spherical symmetry and make performing theoretical analysis even harder.  
   	
   	\quad In all, we can find that providing analytical solutions for the eigenvalues and eigenfunctions when considering the Slepian concentration problem in high dimensions is very difficult. Therefore, obtaining numerical solutions after deriving the integral equations, which is not the best but is a practically feasible route, is chosen in our paper. Besides numerical simulations, we also provide some quantitative and qualitative analyses and discussions of the properties of the eigenvalues based on the derived kernel functions, which will be shown in the following parts.
   }
   
   {\bf C. Slepian concentration problem in three-dimensional space-wavenumber domain for electromagnetic field}
   
   {\color{red}
   
   \quad From {\bf Remark} 5 we have shown how the eigenvalues of the Slepian concentration problem influence the fDoF of the electromagnetic field. Now we will have some discussions about the properties of the eigenvalues, including the decay rate, the possible large values, and their relationship with the varying speed of the eigenfunctions, etc. These properties can also be observed in the numerical simulation part. 
   
   \quad We now focus on the kernel functions $D_1({\bf x},{\bf x}')=\frac{1}{2\pi^2} \left( \frac{\sin k_0\left\| {\bf x}-{\bf x}' \right\|}{\left\| {\bf x}-{\bf x}' \right\|^3}-\frac{k_0\cos k_0\left\| {\bf x}-{\bf x}' \right\|}{\left\| {\bf x}-{\bf x}' \right\|^2} \right)$ in (30) and $D_2({\bf x},{\bf x}') = \frac{1}{2\pi^2} \frac{k_0\sin k_0 \left\| {\bf x}-{\bf x}' \right\|}{\left\|  {\bf x}-{\bf x}' \right\|}$ in (42), as they represent two extreme cases with full band $(0,\omega_0]$ and single-frequency point $\omega_0$. First of all, we will discuss the decay rate of the eigenvalues of the integral operators with these two kernels. In [44], the eigenvalues obey the rule $\lambda_n  = o(n^{-k-1})$, where $k$ is the order of differentiability of the kernel function of the integral operator. Therefore, determining the differentiability (smoothness) helps to predict the long-term behavior of the eigenvalues.
   It is easy to observe that $D_1({\bf x},{\bf x}')$ and $D_2({\bf x},{\bf x}')$ are real analytic if we do not consider the point ${\bf x} = {\bf x}'$. Now we will examine if they are real analytic at ${\bf x} = {\bf x}'$. 
   Note that $D_1({\bf x},{\bf x}')$ and $D_2({\bf x},{\bf x}')$ are determined by $\left\|{\bf x}-{\bf x}'\right\|$. We only need to check the radial functions $E_1(r) = \frac{1}{2\pi^2} \left( \frac{\sin k_0 r}{r^3} - \frac{k_0 \cos k_0 r}{r^2} \right)$ and $E_2(r) = \frac{1}{2 \pi^2} \frac{k_0 \sin k_0 r}{r}$ at the origin $r = 0$. Utilizing Taylor's expansion, we have 
   \begin{equation}\begin{aligned}\sin(k_0r)&=k_0r-\frac{(k_0r)^3}{6}+\frac{(k_0r)^5}{120}+O(r^7),\\\cos(k_0r)&=1-\frac{(k_0r)^2}{2}+\frac{(k_0r)^4}{24}+O(r^6),\end{aligned}\end{equation}
   which means that the Taylor expansions of $E_1(r)$ and $E_2(r)$ only contain even powers of $r$ and ensures the real analyticity of $D_1$ and $D_2$. Then we know that these two kernels are smooth or infinitely differentiable. From {\bf Theorem 5} in [45], it was shown that the eigenvalues $\{\lambda_n\}$ of a smooth radial kernel defined in a $d$-dimensional space can be upper-bounded by $\lambda_n \leqslant C' e^{-C n^{1/d}}$ where $C$ and $C'$ are constants related to the kernel. Therefore, we can conclude that the eigenvalues of the integral operators with kernel $D_1$ and $D_2$ will decay to 0 with sub-exponential speed.   
   
   \quad Moreover, when checking the Fourier transforms of the kernel functions $D_1$ and $D_2$, it is easy to observe from their derivation procedure that $D_1$ has a broader basis on $k \in (0,k_0]$ while $D_2$ only on a single point. Then from a qualitative perspective, we know that $D_1$ and $D_2$ have the same spherical symmetry in the wavenumber domain. Their difference exists in the radius dimension. To be more specific,
   $D_1$ excites all possible modes that are below the frequency limit $w_0$, which tends to result in a series of similar large eigenvalues. On the contrary, $D_2$ only excites one mode at the frequency point $w_0$, which tends to result in one or only a few large eigenvalues. 
   
   \quad It is also worth noting that the integral operators mentioned above can be viewed as low-pass filters since they tend to keep the slow-varying components due to the smoothness of the kernels. Therefore, it is expected that when solving the concentration problem, the eigenfunctions that more slowly on the space domain will correspond to larger eigenvalues. According to {\bf Remark} 5, these eigenfunctions serve as good electromagnetic bases since they are more important when constructing required transmitted fields compared to other eigenfunctions, which will be verified in the simulation parts.
   }
   
   {
   \color{red}
   \setcounter{remark}{5} 
   \begin{remark}
   	
   	(relationship between asymptotic and non-asymptotic DoF) In the above parts, we have discussed the models and schemes to analyze and solve the concentration problem for non-asymptotic DoF. Although it is hard to quantitatively discuss the exact value of non-asymptotic DoF, which relies on numerical calculations and the error bound $\epsilon$ as in {\bf Definition} 1, here we propose a conjecture whose generality remains unproven. More precisely, the non-asymptotic DoF with small $\epsilon$, although being obviously smaller than the asymptotic case that involves larger spatial and wavenumber constraint regions, will exceed the asymptotic case when both of them are averaged over the sizes of the spatial and wavenumber constraint regions. The reason is that observations confined to a finite region inherently exploit the structural characteristics of the field, which effectively convey partial information from outside the region. One observation of this phenomenon in the one-dimensional time-frequency case has been shown in Fig. 2, in which the dotted line (Cut-off transition) refers to the average DoF of asymptotic case. It can be observed that for finite $\Omega T$, the line has a tail at the right side of the Cut-off transition line, which is more obvious for smaller $\Omega T$. This tail means extra DoF above the average DoF when considering a small $\epsilon$. For the three-dimensional scenario in the space-wavenumber domain we also provide a numerical case in Fig. 3, which comes from the integral equation with kernel function (30). It can be observed that the same phenomenon also exists in the three-dimensional scenario, when considering average DoF over the sizes of the spatial and wavenumber constraint regions, the non-asymptotic case will exceed the asymptotic case. We have also found a similar phenomenon when considering mutual information with a finite observation window in the time domain [46].
   	
   	
   \end{remark}
   }
\end{framed}

{\color{blue}
	{\bf References:}
	
	[30] D. Slepian and H. O. Pollak, “Prolate spheroidal wave functions, Fourier analysis and uncertainty—I,” {\it Bell System Technical
	Journal}, vol. 40, no. 1, pp. 43–63, Jan. 1961.
	
	[31] D. J. Thomson, “Spectrum estimation and harmonic analysis,” {\it Proc. IEEE}, vol. 70, no. 9, pp. 1055–1096, 2005.
	
	[32] T. M. Cover, Elements of information theory. John Wiley \& Sons, 1999.
	
	[33] H. Xiao, V. Rokhlin, and N. Yarvin, “Prolate spheroidalwavefunctions, quadrature and interpolation,” {\it Inverse problems}, vol. 17,
	no. 4, p. 805, 2001.
	
	[34] F. Furrer, M. Berta, M. Tomamichel, V. B. Scholz, and M. Christandl, “Position-momentum uncertainty relations in the presence
	of quantum memory,” {\it Journal of Mathematical Physics}, vol. 55, no. 12, 2014.
	
	[35] D. Slepian, “Prolate spheroidal wave functions, Fourier analysis and uncertainty—IV: extensions to many dimensions; generalized
	prolate spheroidal functions,” {\it Bell System Technical Journal}, vol. 43, no. 6, pp. 3009–3057, 1964.
	
	[36] F. J. Simons, F. Dahlen, and M. A. Wieczorek, “Spatiospectral concentration on a sphere,” {\it SIAM review}, vol. 48, no. 3, pp. 504–536,
	2006.
	
	[37] A. P. Bates, Z. Khalid, and R. A. Kennedy, “Slepian spatial-spectral concentration problem on the sphere: Analytical formulation
	for limited colatitude–longitude spatial region,” {\it IEEE Trans. Signal Process.}, vol. 65, no. 6, pp. 1527–1537, Mar. 2017.
	
	[38] G. Beylkin, C. Kurcz, and L. Monz´on, “Grids and transforms for band-limited functions in a disk,” {\it Inverse Problems}, vol. 23,
	no. 5, p. 2059, 2007.
	
	[39] F. J. Simons and D. V. Wang, “Spatiospectral concentration in the Cartesian plane,” {\it GEM-International Journal on Geomathematics},
	vol. 2, no. 1, pp. 1–36, 2011.
	
	[40] Y. Shkolnisky, “Prolate spheroidal wave functions on a disc—integration and approximation of two-dimensional bandlimited
	functions,” {\it Applied and Computational Harmonic Analysis}, vol. 22, no. 2, pp. 235–256, 2007.
	
	[41] J. Zhang, H. Li, L.-L. Wang, and Z. Zhang, “Ball prolate spheroidal wave functions in arbitrary dimensions,” {\it Applied and
	Computational Harmonic Analysis}, vol. 48, no. 2, pp. 539–569, 2020.
	
	[44] J. Reade, “Eigen-values of Lipschitz kernels,” in Mathematical Proceedings of the Cambridge Philosophical Society, vol. 93, no. 1.
	{\it Cambridge University Press}, 1983, pp. 135–140.
	
	
	[45] M. Belkin, “Approximation beats concentration? An approximation view on inference with smooth radial kernels,” {\it in Conference
	On Learning Theory. PMLR}, 2018, pp. 1348–1361.
	
	[46] J. Zhu, Z. Zhang, Z. Wan, and L. Dai, “On finite-time mutual information,” {\it in Proc. 2022 IEEE International Symposium on
	Information Theory (ISIT)}, 2022, pp. 2910–2915.
}

\textbf{Reviewer 2:}
6. On p8, “When n → $\infty$, F2(k) → $\delta$(k - k0)”,  the Dirac delta function is not well-defined. Does using a different representation for the delta function for F2(k) change the DoF?


{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable comment. We have added more rigorous definitions about explanations about the delta function. We have also added explanations about why the DoF will not be changed when choosing a different representation for the delta function, which is guaranteed by the properties of the approximate identities [43].


The detailed revisions are shown as follows:
}}

\begin{framed}
	{\bf Section III. C}

The eigenvalues comes from the following integral equation
\begin{equation}
	\lambda_i f_i({\bf x}) = \int_{\mathcal{R}}D({\bf x},{\bf x}')f_i({\bf x}'){\rm d}^3{\bf x}'.
	\label{eigenfunction_3d}
\end{equation}
Here we set $\{F_{2,n}(k)\}_{n=1}^{+\infty} = \frac{1}{2h}\left( 1-\frac{|k-k_0|}{2h} \right), |k-k_0|\leqslant 2h$, $h = \frac{1}{2^n}$ to be a set of functions that make $F({\bf k})$ focus on a sphere surface in the wavenumber domain. When $n \rightarrow \infty$, $F_2(k) \rightarrow \delta(k-k_0)$. {\color{red} In a more rigorous description, we have $\underset{n \rightarrow +\infty}{\rm lim}{\int_{\mathbb{R}} F_2(k)f(k) } = f(k_0)$ for arbitrary smooth and compactly supported function $f(k) \in C_c^{\infty}({\mathbb R})$. It is worth noting that we use the function series $\{F_{2,n}(k)\}_{n=1}^{+\infty}$ due to two reasons. Firstly, we can establish the connection between the case where the support in the wavenumber domain has a continuous extent in $k$ (finite n), and the case localized only at the point $k_0$ ($n \rightarrow \infty$). Secondly, we can avoid directly using delta functions since they are not genuine functions but generalized functions, which possess some properties that can not be achieved by real-valued functions. Using a series of well-defined integrable functions, known as approximate identities, to approach the delta function is a common way used in existing literature [42]. From the above discussions, we can also observe that the functions $\{F_{2,n}(k)\}_{n=1}^{+\infty}$ can not be arbitrarily chosen. They should satisfy the power constraint $\int F_2(k) {\rm d}k = 1$ and describe a unit point mass at $k = k_0$ when $n \rightarrow \infty$ (or can be equivalently described as "support set shrinks to 0 when $n \rightarrow \infty$")
	from the limitation perspective
	[43]. 
	Then they all have the property $\underset{n \rightarrow +\infty}{\rm lim}{\int_{\mathbb{R}} F_2(k)f(k) } = f(k_0)$. There are infinite choices for such function series, but they have the same limitation as the delta function [43] and will lead to the same DoF.} 
\end{framed}
 
 {\color{blue}
 	{\bf References:}
 	
 	[42] R. S. Strichartz, A guide to distribution theory and Fourier transforms. World Scientific Publishing Company, 2003.
 	
 	[43] N. Wheeler, “Simplified production of Dirac delta function identities,” {\it Reed College}, 1997.
 }
 
 \textbf{Reviewer 2:}
7. What is the reason for introducing an approximation error $\epsilon$ in the definition of both functional and channel DoFs? For example, in the MIMO channel, the DoF is deterministic without any error terms. But why do the DoFs here have an error term?

 
 
 {\color{blue}{\textbf{Authors: } 
 Thanks for the reviewer's valuable question. The reason for introducing an approximation error $\epsilon$ is that we are considering continuous electromagnetic fields instead of discrete signals. In traditional discrete models we are using  discrete matrices which have finite ranks. However, for continuous electromagnetic fields, we are tackling Hilbert spaces with infinite dimensions. Now there is a contradiction between the theoretical model and practical schemes. In practical communication tasks, using an infinite number of base functions, which corresponds to infinite electromagnetic modes, is impossible and often unnecessary. The reason is that only a few base functions contribute a lot to the field reconstruction, while the remained base functions can be discarded with small loss of precision. The above observation motivates us to use the error $\epsilon$ to filter out unnecessary basis and obtain the number of basis we need, which is the DoF defined in the paper.
 		
 		
 According to the reviewer's comment, we have added more explanations about the reason for introducing $\epsilon$. The detailed revisions are shown as follows:
 }}
 
 \begin{framed}
 	{\bf Section II.B}
 	
 	{\color{red}
 	\quad As is shown in (\ref{eqn_dispersion_relation}), there are some physical restrictions that the electromagnetic fields should obey in wireless communication systems. These restrictions relate to time, frequency, space, and wavenumber domain. All possible electromagnetic fields considering these restrictions span a Hilbert space whose dimension is the number of basis needed to express an arbitrary field in the space. 
 	
 	\quad Note that, unlike a discrete matrix, the dimension of a continuous Hilbert space may be infinite. However, in practical communication tasks, using an infinite number of base functions, which corresponds to infinite electromagnetic modes, is impossible and often unnecessary. The reason is that only a few base functions contribute a lot to the field reconstruction, while the remained base functions can be discarded with small loss of precision. We will give a mathematical definition of the DoF based on the above discussion and verify its rationale in the following sections of the paper. 
 	}
 	\end{framed}

{\color{blue}{\textbf{Authors: } 
Many thanks again for your valuable time and efforts to review this paper. 
\\
\\
Sincerely, \\
{\it The Authors }
}}

\clearpage 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{center}
    {\Large\bf Response to Reviewer 3's Comments}
\end{center}

\textbf{Reviewer 3:}
This paper proposes a near-field channel model based on EM scattering theory and a zero-mean Gaussian random field. The outcome is the analytical derivation of the autocorrelation function. Subsequently, the authors verify numerically the sparsity and ensure that the model is consistent with 5G CDL models. Finally, they propose a channel estimator that exploits sparsity and the near-field effect, providing better performance compared to baseline estimators.

The paper is generally well-written. However, I have several doubts about its technical soundness, as detailed below. Therefore, I do not recommend it for publication.

{\color{blue}{\textbf{Authors: } 
We appreciate the reviewer's concise summary of the key points of this paper. We have tried our best to address these issues in the revised paper according to the reviewer's concerns. Our responses are provided in a point-to-point manner as below. 
}}

\textbf{Reviewer 3:}
Detailed comments:

The core of the paper is the analytical modeling of the autocorrelation function of the scattered field in the near field. The derivation is based on several simplifying assumptions that I try to summarize below:

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer's concise summary about the assumptions and simplifications adopted in this paper. We have added a remark in the paper to summarize these simplifications, shown in the following box.}}

\begin{framed}
	{\bf Section III. A}

    {\color{red}
\begin{remark}
    \quad In this paper before we arrive at {\bf Lemma 1}, several assumptions and simplifications are provided to reduce the analysis complexity and facilitate the derivation of an analytical result. These assumptions and simplifications include that 1) spatially uncorrelated scattered field adopted in [31], [32] and [33], which implies an ideal but mathematically friendly assumption that the material properties are varying instantaneously in the spatial domain; 2) scattering region and gain function both for analysis convenience and generality, which covers different scatterer shapes like circle surface [36], ring [37], and single point [38]; 3) distance is far larger than dimension of the scatterer; 4) distance is far larger than wavelength [28]; 5) scalar electromagnetic fields as in [22]. By changing these assumptions or discarding these simplifications, more accurate and general model may be obtained. 
	\end{remark}}

\end{framed}

{{\color{blue}For the detailed explanations about each assumptions and simplifications, we will list them in the following parts in a point-to-point manner.
}}

\textbf{Reviewer 3:}

-   After Eqn. (4): Uncorrelated scattered field, i.e., $E[E(r1)E(r2)] = \beta \delta(r1-r2)$. It means that two observations of the electric field within the scatterer are always independent. This assumption appears quite unrealistic.

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer's summary about the assumption  adopted in this paper. For equation (4) in the original paper (now equation (8)), this assumption is adopted in several existing papers [31-33], implying that the material properties are varying instantaneously in the spatial domain. We agree with the reviewer that realistic materials may have more complex characteristics, which provide more accurate models but make the theoretical analysis harder. We add an explanation part of the uncorrelated scatterer field in the paper, summarizing several different modeling schemes in the existing papers. We will work on more complex scatterer field correlation function in the future.

The detailed revisions are shown in the following box:

}}

\begin{framed}
	{\bf Section III. A}

    To derive a closed-form expression of the channel model we need to have some assumptions on the scattering field to do simplifications on (8). {\color{red} Considering the uncertainty of the inhomogeneity of the space, simplified models need to be used for the field correlation on the scatterer surfaces for ease of analysis. In the literature, some models have been already proposed. For example, delta function type of field spatial correlation was discussed in [31], [32] and [33], which implies an ideal but mathematically friendly assumption that the material properties are varying instantaneously in the spatial domain. A more complex model like exponential type of field spatial correlation was discussed in [34]. Angular delta function as the spectrum of the field was proposed in [35]. For simplicity, we adopt delta function as the spatial correlation of the fields on the scattering surface, leading to $\mathbb{E}\left[ E({\bf r}_1')E^{*}({\bf r}_2') \right] = \beta \delta({\bf r}_1'-{\bf r}_2')$.}

\end{framed}


\textbf{Reviewer 3:}
-   The scattering region is distributed in a solid circle facing the receiver.

-   The scattering gain function in Eqn. (6), from which the final model strongly depends, enters the loop without any reference. It seems it has been introduced mainly for mathematical convenience.

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer's valuable comment. These two assumptions are combined together to offer a general model to cover different shapes of scatterers bounded in a circle. When $a$ changes, the weights of the scatterer in different positions of the circle change. Then, for different $a$, the scatterer behaves like ring, surface or single point, which are models used in several existing papers [36-38]. The chosen of scattering gain $f({\bf r}')$, is a compromise between model generality and mathematical analysis simplicity. With $f({\bf r}') = \frac{a+1}{\pi r_s^{2a+2}} (r_s^2-\rho^2)^{a}$, we can both cover several different scatterer shapes, and derive an analytical result of the field correlation at the receiver.

According to the reviewer's comments, we have explained the chosen of $f({\bf r}')$ in the paper, shown in the following box:
}}

\begin{framed}
	{\bf Section III. A}

    Specifically, we model it by 
	\begin{equation}
		f({\bf r}') = (k^2({\bf r}')-k_0^2)^2  =\left\{\begin{matrix}
		\frac{a+1}{\pi r_s^{2a+2}} (r_s^2-\rho^2)^{a}	&\left| \rho \right|\leqslant r_s, \\ 
		0	& {\rm otherwise},
		\end{matrix}\right.
		\tag{10}
	\end{equation}
where $\boldsymbol{\rho} = {\bf r}' - {\bf d}$, $\rho = \|\boldsymbol{\rho}\|$, and $a$ is a parameter characterizing the concentration of scatterer around the central point. {\color{red} This assumption for $f({\bf r}')$ is heuristic, which aims at providing a general model to cover different shapes of scatterers. By changing the parameter $a$, the scatterer varies from ring to single point.
For example, when $a = 0$, the scattering region is a uniform circular surface used in [36]. When $a \rightarrow -1$, the scatterer approximates a ring as in [37]. When $a \rightarrow +\infty$, the scattering region shrinks to a single point, which is widely adopted in existing works for near-field [38].}
\end{framed}

\textbf{Reviewer 3:}
-   The dimension of the scatterer is much less than the distance with the receiver, then only weak near-field conditions are modeled as a consequence.

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer's valuable comment. In our paper we perform this assumption mainly because an analytical result can be derived in this scenario. For larger scatterer, the channel can be constructed by combing the channels with smaller scatterers. We have add explanations about this assumption in the paper. Detailed revisions are shown as:
}}

\begin{framed}
{\bf Section III.A}

\setcounter{equation}{14}

\quad Through mathematical derivations and simplifications, we can derive the spatial correlation function of the channel in the following lemma, {\color{red}where scatterer dimension is relatively small compared to the distance}:
\begin{lemma}[{\color{red}Correlation function of the channel in weak near-field}]
	Assuming that $r_s \ll d$, the correlation function of the channel can be approximated by 
	\begin{equation}
		\begin{aligned}
			\tilde{R}({\bf r}_1,{\bf r}_2) =& \frac{\beta}{8\pi^2d^2\sqrt{A({\bf r}_1)A({\bf r}_2)}}e^{{\rm j}\frac{2\pi}{\lambda}R \left(\sqrt{A({\bf r}_1)}-\sqrt{A({\bf r}_2)}\right)} \\&(a+1) 2^{a} \Gamma (a+1) (\sqrt{C}r_s)^{-(a+1)} J_{a+1} (\sqrt{C}r_s),
		\end{aligned}
	\end{equation}
	where
	\ifx\onecol\undefined
   \begin{equation}
	   \begin{aligned}
		   C =& \left( \frac{2\pi}{\lambda}  \right)^2 \Bigg( \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_1)}} - \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_2)}} - \frac{r_1}{d} \frac{\hat{\bf r}_1 \cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_1)}} + \frac{r_2}{R} \frac{\hat{\bf r}_2 \cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_2)}}\Bigg)^2 \\&+  \left( \frac{2\pi}{\lambda}  \right)^2 \Bigg( \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_1)}} - \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_2)}} - \frac{r_1}{d} \frac{\hat{\bf r}_1 \cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_1)}} + \frac{r_2}{d} \frac{\hat{\bf r}_2 \cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_2)}}\Bigg)^2.
	   \end{aligned}
   \end{equation}
   \else
   \begin{equation}
	   \begin{aligned}
		C =& \left( \frac{2\pi}{\lambda}  \right)^2 \Bigg( \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_1)}} - \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_2)}} - \frac{r_1}{d} \frac{\hat{\bf r}_1 \cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_1)}} + \frac{r_2}{R} \frac{\hat{\bf r}_2 \cdot \hat{\boldsymbol{\mu}}_1}{\sqrt{A({\bf r}_2)}}\Bigg)^2 \\&+  \left( \frac{2\pi}{\lambda}  \right)^2 \Bigg( \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_1)}} - \frac{\hat{\bf d}\cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_2)}} - \frac{r_1}{d} \frac{\hat{\bf r}_1 \cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_1)}} + \frac{r_2}{d} \frac{\hat{\bf r}_2 \cdot \hat{\boldsymbol{\mu}}_2}{\sqrt{A({\bf r}_2)}}\Bigg)^2.
	   \end{aligned}
   \end{equation}
   \fi
	\end{lemma}
	\begin{IEEEproof}
	See Appendix A.
	\end{IEEEproof}

\quad For the channel with multiple scatterers, the correlation function can be expressed by
\begin{equation}
	\begin{aligned}
		R({\bf r}_1,{\bf r}_2) = \sum_{k=1}^{M}\tilde{R}_k({\bf r}_1,{\bf r}_2),
	\end{aligned}
	\label{fig_R_multiple}
\end{equation}		
where each $\tilde{R}_k({\bf d}_1,{\bf d}_2)$ is constructed according to {\bf Lemma 1}. {\color{red}For the channel with a large scatterer, we can decompose it to several small scatterers and express the channel in the form of (\ref{fig_R_multiple}).}
    
\end{framed}

\textbf{Reviewer 3:}
In addition to the above explicitly stated assumptions, there are other implicit assumptions that are not declared:

-   Scalar EM fields are considered. Therefore, the effect of polarization is neglected.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's comment. In our paper we adopt the scalar form of EM fields to simplify the analysis, as in [22-24]. Under this assumption the polarization effect is neglected. We have added comments about this modeling assumption in the paper to make it clearer. 
The detailed revisions are shown below:

}}

\begin{framed}
{\bf Section II}

\setcounter{equation}{6}

{\color{red}Since ${\rm tr}({\bf I}-{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})({\bf I}-{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})^{\rm H} = 2$ is a constant, the average power of the electromagnetic field does not depend on the direction ${\bf{\hat p}}$ if the energy of the source current is equally distributed in all polarization directions. Then for simplicity in this paper we reduce the vector wave field to scalar wave field showing the power of electric field averaged on all polarization directions. Physically if we consider the electromagnetic fields on a specific polarization direction $\hat{\bf a}$, an extra factor $\hat{\bf a}({\bf{I}} - {\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})\hat{\bf a}^{\rm H}$ should be added. Under the scalar wave field we have
\begin{equation}
	\begin{aligned} 
		E({\bf r}) =& {\rm j}\omega\mu_0\int_{V_s} g({\bf r},{\bf r}')J({\bf r}'){\rm d}{\bf r}' + \int_{V} g({\bf r},{\bf r}')(k^2({\bf r}')-k_0^2)  E({\bf r}'){\rm d}{\bf r}',
	\end{aligned}
	\label{equ_scattering_field_scalar}
\end{equation}		
where $g({\bf r},{\bf r}') = \frac{1}{2\pi}\frac{e^{{\rm j}k_0\| {\bf r}-{\bf r}' \|}}{\|{\bf r}-{\bf r}' \|}$.}


\end{framed}

\textbf{Reviewer 3:}
-   The general scattering problem involves the solution of complex integral equations (see Franceschetti's book "Wave Theory of Information," Chapter 10). The approximation considered here must be declared and discussed.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer for pointing out this problem. We agree with the reviewer that our discussion is not clear and strict enough. We now reorganize this part, adopting the analyzing scheme in [19] to show the whole process before arriving at the final model. The approximations we adopted in the paper are then discussed. Detailed revisions in the paper are shown in the following box:

}}

\begin{framed}
	{\bf Section II}

	\setcounter{equation}{0}

    \quad Maxwell's equations are the fundamental physical laws of the electromagnetic system. For the characteristics of the scattering system, we can consider the scatterers as spatial non-uniformity of the electromagnetic characteristics like permittivity $\epsilon$ and permeability $\mu$. {\color{red}We adopt the time-harmonic assumption which assumes that the electromagnetic waves oscillates on a single frequency point. Then we have ${\bf E}({\bf r},t) = {\bf E}({\bf r})e^{-{\rm j}\omega t}$, and the partial derivative $\partial/\partial t$ can be replaced by $-{\rm j}\omega$ [26].
Then from the Maxwell's equations we have}
\begin{subequations}
	\begin{align} 
		&\nabla \times {\bf E}({\bf r}) = {\rm j}\omega \mu({\bf r}) {\bf H}({\bf r}), \label{maxwell_1}\\
		& \nabla \times {\bf H}({\bf r}) = -{\rm j}\omega \epsilon({\bf r}) {\bf E}({\bf r})+{\bf J}({\bf r}),  \label{maxwell_2}\\
		& \nabla \cdot  (\epsilon({\bf r}) {\bf E}({\bf r})) = \rho({\bf r}),\\
		& \nabla \cdot (\mu({\bf r}) {\bf H}({\bf r})) = 0,
	\end{align}
\end{subequations}
where $\epsilon({\bf r})$, ${\mu}({\bf r})$ and $\rho({\bf r})$ represents the permittivity, permeability and charge density at the position ${\bf r}$. In homogeneous media, $\epsilon({\bf r})$ and ${\mu}({\bf r})$ will be constant, which is often used in light-of-sight channel modeling in the free space. Now we are considering inhomogeneous media, which can express the electromagnetic characteristics of scattering fields [19]. 

{\color{red}
	\quad By performing $\nabla\times$ on (\ref{maxwell_1}), we have
	\begin{equation}
		\nabla \times \mu({\bf r})^{-1} \nabla \times {\bf E}({\bf r}) = \nabla \times ({\rm j}\omega{\bf H}({\bf r})),
	\end{equation}
	 which leads to the corresponding vector wave equation
	 \begin{equation}
	 	\nabla \times \mu({\bf r})^{-1} \nabla \times {\bf E}({\bf r}) - \omega^2 \epsilon({\bf r})  {\bf E}({\bf r}) = {\rm j}\omega {\bf J}({\bf r}),
	 \end{equation}
	 where $k({\bf r}) = \omega \sqrt{\mu({\bf r})\epsilon({\bf r})}$ represents the inhomogeneous media over a finite domain $V$ according to [19], and ${\rm j}\omega {\bf J}({\bf r})$ represents the source field. Outside the domain $V$, the wavenumber $k({\bf r})$ equals $k_0 = \omega\sqrt{\mu_0\epsilon_0}$.
	 By subtracting $\nabla \times \mu_0 \nabla  \times {\bf E}({\bf r})- \omega^2 \epsilon_0 {\bf E}({\bf r})$ from both sides and applying the Green's function, the received electric field can be expressed by
\begin{equation}
	\begin{aligned} 
		{\bf E}({\bf r}) &= {\rm j}\omega\int_{V_s} {\bf G}({\bf r},{\bf r}')\mu_0{\bf J}({\bf r}'){\rm d}{\bf r}' 
		+ \int_{V} {\bf G}({\bf r},{\bf r}')(k^2({\bf r}')-k_0^2) 
		{\bf E}({\bf r}'){\rm d}{\bf r}',
	\end{aligned}
	\label{equ_scattering_field}
\end{equation}
where $V_s$ is the source region which generates the signal, ${\bf E}({\bf r}')$ is the induced electric field in the inhomogeneous regions in the space, and the dyadic Green's function ${\bf G}$ is the solution of the equation
\begin{equation}
	\begin{aligned} 
		\nabla \times \mu_0^{-1} \nabla \times {\bf G}({\bf r},{\bf r}') - \omega^2 \epsilon_0  {\bf G}({\bf r},{\bf r}') = \mu_0^{-1} {\bf I} \delta({\bf r}-{\bf r}').
	\end{aligned}
\end{equation}
Then, we can obtain the Green's function as ${\bf G}({\bf r},{\bf r}') = \frac{1}{{4\pi }} \left( {{\bf{I}} + \frac{{{\nabla _{\bf{r}}}\nabla _{\bf{r}}^{\rm{H}}}}{{{\kappa_0 ^2}}}} \right) \frac{{{e^{{\rm{j}}\kappa_0 \left\| {{\bf{r}} - {\bf{r}'}} \right\|}}}}{{\left\| {{\bf{r}} - {\bf{r}'}} \right\|}} $, which can be further expressed by [27]:
\begin{equation}
	\begin{aligned}
		{\bf{G}}({\bf{r}},{\bf{r}'}) =& \frac{1}{{4\pi }}\frac{{{e^{{\rm{j}}\kappa_0 \left\| {{\bf{r}} - {\bf{r}'}} \right\|}}}}{{\left\| {{\bf{r}} - {\bf{r}'}} \right\|}}\Bigg[\left( {{\bf{I}} - {\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}}} \right) + \frac{{\rm j}}{2\pi \left\| {{\bf{r}} - {\bf{r}'}} \right\| /\lambda}\left( {\bf I}-3{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}} \right) \\&-\frac{1}{(2\pi\left\| {{\bf{r}} - {\bf{r}'}} \right\|/\lambda )^2 }\left( {\bf I}-3{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}}  \right) \Bigg] [{\rm m}^{-1}],
		\label{Green}
	\end{aligned}
\end{equation}
where ${\bf{\hat p}} = \frac{{\bf{r}} - {\bf{r}'}}{{\left\| {\bf{r}} - {\bf{r}'} \right\|}}$.
Here we assume that $\left\| {{\bf{r}} - {\bf{r}'}} \right\|/\lambda \gg 1$, which means that the receiver is in far-field of the scatterer's microstructure and holds true in general wireless communication scenarios [28]. Then, we can omit the items containing powers of $\frac{1}{\left\| {{\bf{r}} - {\bf{r}'}} \right\|/\lambda}$. Since ${\rm tr}({\bf I}-{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})({\bf I}-{\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})^{\rm H} = 2$ is a constant, the average power of the electromagnetic field does not depend on the direction ${\bf{\hat p}}$ if the energy of the source current is equally distributed in all polarization directions. For simplicity, in this paper we reduce the vector wave field to scalar wave field showing the power of electric field averaged on all polarization directions. Physically if we consider the electromagnetic fields on a specific polarization direction $\hat{\bf a}$, an extra factor $\hat{\bf a}({\bf{I}} - {\bf{\hat p}}{{{\bf{\hat p}}}^{\rm{H}}})\hat{\bf a}^{\rm H}$ should be added. Under the scalar wave field we have
\begin{equation}
	\begin{aligned} 
		E({\bf r}) =& {\rm j}\omega\mu_0\int_{V_s} g({\bf r},{\bf r}')J({\bf r}'){\rm d}{\bf r}' + \int_{V} g({\bf r},{\bf r}')(k^2({\bf r}')-k_0^2) 
		E({\bf r}'){\rm d}{\bf r}',
	\end{aligned}
	\label{equ_scattering_field_scalar}
\end{equation}		
where $g({\bf r},{\bf r}') = \frac{1}{2\pi}\frac{e^{{\rm j}k_0\| {\bf r}-{\bf r}' \|}}{\|{\bf r}-{\bf r}' \|}$.
}
The equation (\ref{equ_scattering_field_scalar}) is an extension from the 2-dimensional case in [29]. Here we can view the first item in (\ref{equ_scattering_field}) as the line-of-sight component of the field which is fixed and well-studied. Then we will focus on the second item in (\ref{equ_scattering_field}) which highly relies on the characteristics of the inhomogeneity of the space. The inhomogeneity of the space depends on the complicated factors such as surface structure and material properties of the medium which are hard to analytically model and may change over time. Therefore, a statistical model will be more suitable to depict the characteristics of the field than deterministic modeling scheme. 
\end{framed}

\textbf{Reviewer 3:}
Starting from the above assumptions, the authors derive a complicated analytical expression for the autocorrelation function of the channel in the presence of M scatterers. Typically, a new channel model is expected to be validated by measurements, especially if based on several simplifying assumptions as here; otherwise, there is a risk that it does not match reality. Instead, the authors compare their autocorrelation function with that obtained numerically from the classical 3GPP CDL model, showing a good match. Therefore, I conclude that what has been proposed is not a new channel model but just an analytical method to obtain an expression for the autocorrelation function of classical existing models. What is the novelty?

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable comments. The benefit of our proposed model is that it is analytical and can well fit the existing models which are complex and do not have an analytical form. Therefore, our model may facilitate further theoretical analysis. Moreover, our model provides a correlation function expression of the received field in near-field scenario. Therefore, it can be used in channel estimation process to provide prior information for MMSE channel estimator.

We have added the explanation of the benefits of the proposed model in the paper. Detailed revisions in the paper are shown in the following box:
}}

\begin{framed}
	{\bf Section IV.B}

	\quad {\color{red} The benefits of the proposed model is that it is analytical and can be used to obtain the field correlation between any two positions by direct and quick calculation, while the existing models need a large amount of parameters.
	For example, the widely-accepted CDL-A model has 23 scatterer clusters and 20 rays in each cluster. Therefore, it is accurate but very complex, making it difficult for further analysis. Moreover, the proposed model provides a correlation function expression of the received field. Therefore, it can be used in channel estimation process to provide prior information for channel estimator.}
\end{framed}

{\color{blue}
Furthermore, in the paper we have added the fitness of the proposed channel to the channel generated by ray tracing scheme, which shows how the proposed model matches real-word scenarios. We choose the building maps in Hong Kong, and use quasi-Newton algorithm to fit the proposed model to the model generated by ray tracing scheme. Detailed revisions are shown in the following box:
}

\begin{framed}
	{\bf Section IV.B}

	\setcounter{figure}{5}

	\quad {\color{red}
	Furthermore, we fit the proposed model to the model generated by ray tracing scheme to show its fitness to practical scenarios. The transceivers locate in Hong Kong, and the paths between the transceivers are characterized by ray tracing scheme, as shown in Fig. \ref{fig_ray_tracing}. We use quasi-Newton algorithm to fit the proposed model to the model generated by ray tracing scheme. The result is shown in Fig. \ref{fig_ray_tracing_fit}. We can observe that the proposed model can well rebuild the channel with limited parameters.}

	\begin{figure}[H]
		\centering 
		\includegraphics[width=0.5\textwidth]{figs/ray_tracing.pdf} 
		\caption{\color{red}The model built from ray tracing scheme in Matlab, which is based on buildings in Hong Kong.} 
		\label{fig_ray_tracing}
	\end{figure}
	
	\begin{figure}[H]
		\centering 
		\includegraphics[width=0.5\textwidth]{figs/ray_tracing_fit_one_side.pdf} 
		\caption{\color{red}Comparison between the proposed model and the model built from ray tracing scheme.} 
		\label{fig_ray_tracing_fit}
	\end{figure}

\end{framed}

\textbf{Reviewer 3:}
As a second step, the authors show the sparsity of the proposed channel model by observing the received signal in the wave domain. However, the sparsity of the channel is not a characteristic of the model but rather a characteristic of the propagation in relation to the considered scenario the model wants to capture, particularly the number of scatterers. It is well-known that in the presence of three scatterer regions, as considered in Fig. 8, the channel seen in the wave domain results in sparsity. I do not see anything new here. If one considers more scatterers, then the channel becomes less sparse. Moreover, the analysis of extended scattered regions in the wave domain can be found in the textbook "Wave Theory of Information" by Franceschetti.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer for pointing out this problem. We agree with the reviewer that the sparsity is the characteristic of the channel, not the proposed model. We have reorganized the corresponding part in the paper, not emphasizing the sparsity as the contribution. 
We plot the wavenumber domain of the model for two reasons:
1. it can help to construct the approximate correlation function according to the received noisy field, so as to provide electromagnetic prior information for channel estimation and improve the channel estimation equality. 
We explain this in the paper as follows:
}}

\begin{framed}
	{\bf Section IV.C}

	\quad {\color{red}If the channel is sparse, from the law of large numbers, we know that $h$ has power peaks in wavenumber domain,
	which can be used in channel estimation of reconstruction procedure to improve the accuracy.} Specifically, if we reshape the vector ${\bf h}$ to a matrix ${\bf H}_{i,:} = {\bf h}_{(i-1)*N_z+1:i*N_z,1}^{\rm T}$, its sparsity in wavenumber domain can be expressed as follows:
	\begin{equation}
		\begin{aligned}
			{\mathbb E}[\left|({\bf F}_1{\bf H}{\bf F}_2)_{i,j}\right|^2] &= {\mathbb E}\left[ \left| \sum_{i'}\sum_{j'}{\bf F}_{1,i,j'}{\bf H}_{i',j'}{\bf F}_{2,i',j}^{\rm H} \right|^2 \right]
			\\& ={\mathbb E}\left[ \sum_{i'_1,i'_2,j'_1,j'_2}{\bf F}_{1,i,j'_1}{\bf H}_{i'_1,j'_1}{\bf F}_{2,i'_1,j}^{\rm H}{\bf F}^{*}_{1,i,j'_2}{\bf H}^{*}_{i'_2,j'_2}{\bf F}_{2,i'_2,j}^{\rm T}\right]
			\\& = \sum_{i_1',i_2',j'_1,j'_2} e^{{\rm j}\frac{2k}{N_y-1}(i-\frac{N_y+1}{2})(j_1'-j_2')d_y}R({\bf r}_1,{\bf r}_2)
			e^{{\rm j}\frac{2k}{N_z-1}(j-\frac{N_z+1}{2})(i_2'-i_1')d_z},
		\end{aligned}
		\tag{23}
	\end{equation}
\end{framed}

{\color{blue}
2. the wavenumber domain of the model has relationship to the channel DoF from the spatial bandwidth perspective. We add the explanation of it in the paper:
}

\begin{framed}
	{\bf Section IV.C}

	\quad For the near-field scattering scenario, the scattering region will correspond to an area rather than a point in the wavenumber domain. The shape of the area reflects the size, directions and concentration parameters of the scattering region. {\color{red} It is also worth noting that the area relates to the concept called spatial bandwidth [13]. The larger the area is, the larger the spatial bandwidth is, which provides more possible DoF for the wireless communication system. Further discussion about the DoF will be presented in the following subsection.}
\end{framed}

{\color{blue}
We also agree with the reviewer that the wavenumber sparsity itself does not have enough novelty. To strengthen the contribution of the paper, we add an extra part, which follows point 2 to discuss the DoF under the proposed channel model. Specifically, we first ultilize spatial bandwidth in [13] and then further analyze the DoF based on conclusions in [43]. Detailed revisions are shown in the following box:
}

\begin{framed}
    {\bf{Section IV.D \color{red}Channel DoF of the proposed model}}

	\setcounter{equation}{23}
	\setcounter{figure}{9}

    \quad In this section we will discuss how the parameters influence the performance of the system from the degree of freedom (DoF) perspective.
    The DoF of the channel depends on the eigenvalue distribution of the model. If the eigenvalue decay rate is slow, there exist multiple subchannels that can support communication at a certain rate, leading to greater DoF. On the contrary, if few eigenvalues are obviously larger than other eigenvalues, the DoF will be small [21]. 
    
    \quad {\color{red} We will provide some insights of the DoF from the spatial bandwidth [13] perspective and then verify them by numerical analysis of the proposed model. The spatial bandwidth characterizes the band-limiting effect of electromagnetic fields in the wavenumber domain, which is similar to the classical bandwidth that depicts a function's band-limiting effect in the frequency domain. The spatial bandwidth shows the electromagnetic fields' DoF through spatial sampling. In [13], the scattered electromagnetic waves ${\bf E}({\bf r})$ are observed on an infinite line or region at the receiver. In this paper we adopt scalar form of the electromagnetic field, leading to $E({\bf r}) = \int_{V} g({\bf r},{\bf r}')(k^2({\bf r}')-k_0^2)  E({\bf r}'){\rm d}{\bf r}'$. We have $\bar{E}({\bf r}) = E({\bf r})e^{-{\rm j}k_0\left\|{\bf r} \right\|}$ to single out the phase factor introduced by the distance, and $X({\bf r}) = (k^2({\bf r})-k_0^2)  E({\bf r})$ on the scatterer surface. Then we have
    \begin{equation}
        \bar{E}({\bf r}) = \int_V \bar{g}({\bf r},{\bf r}') X({\bf r}') {\rm d}{\bf r}',
    \end{equation}
    where $\bar{g}({\bf r},{\bf r}') = \frac{1}{2\pi}\frac{e^{{\rm j}k_0(\left\| {\bf r}-{\bf r}' \right\|-\left\| {\bf r} \right\|)}}{\left\| {\bf r}-{\bf r}' \right\|}$. For simplicity, we focus on the one-dimensional receiver and abbreviate $\bar{E}({\bf r})$ as $\bar{E}({r})$, $\bar{g}({\bf r},{\bf r}')$ as $\bar{g}({r},{\bf r}')$, where $r$ is along a chosen line determined by ${\bf r}$ in the three-dimensional space. To show the how $\bar{E}({r})$ is band-limited in the wavenumber domain, we introduce $\bar{E}_w({r}) = \bar{E}({r}) * \frac{\sin w r}{r}$ which performs low-pass filtering on $\mathscr{F}[\bar{E}({r})]$. Then we have 
    \begin{equation}
        \bar{E}_w({r}) = \int_V \bar{g}_w({r},{\bf r}') X({\bf r}') {\rm d}{\bf r}',
    \end{equation}
    where 
    \begin{equation}
        \begin{aligned}
        \bar{g}_w({r},{\bf r}') &= \frac{1}{2\pi^2} \int_{-\infty}^{+\infty} \frac{\sin w(r-\xi)}{r-\xi}\frac{e^{{\rm j}k_0(\left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\|)}}{\left\| \boldsymbol{\xi}-{\bf r}' \right\|}{\rm d}\xi
        \\& \overset{a}{=} \frac{1}{2\pi^2{\rm j}} \int_{C^+} \frac{e^{ {\rm j}w(r-\xi)}}{r-\xi}\frac{e^{{\rm j}k_0(\left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\|)}}{\left\| \boldsymbol{\xi}-{\bf r}' \right\|}{\rm d}\xi 
        \\& ~~~~- \frac{1}{2\pi^2{\rm j}} \int_{C^-} \frac{e^{ -{\rm j}w(r-\xi)}}{r-\xi}\frac{e^{{\rm j}k_0(\left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\|)}}{\left\| \boldsymbol{\xi}-{\bf r}' \right\|}{\rm d}\xi 
        \\&~~~~+ \bar{g}({r},{\bf r}'),
        \end{aligned}
    \end{equation}
    in which $\overset{a}{=}$ is from the residual theorem, $C^+$ and $C^-$ are two paths above and below the real axis.
    The spatial bandwidth is the minimum $w$ that makes $\left\|\bar{E}(r)-\bar{E}_w(r)\right\|$ small enough. 
    We have 
    \begin{equation}
        \begin{aligned}
        \left\|\bar{E}(r)-\bar{E}_w(r)\right\| &=  \left[\int_{-\infty}^{+\infty}  \left|\bar{E}(r)-\bar{E}_w(r)\right|^2{\rm d}r \right]^{\frac{1}{2}}
        \\& \leqslant \underset{{\bf r}'}{\rm max} \left[ \int_{-\infty}^{+\infty} \left| \Delta \bar{g}({r},{\bf r}') \right|^2{\rm d}{\bf r}'  \right]^{\frac{1}{2}} 
        \\& ~~~~\cdot \int_V \left| X({\bf r}') \right| {\rm d}{\bf r}',
        \end{aligned}
    \end{equation}
    where $\Delta \bar{g} = \bar{g}-\bar{g}_w$ is the item corresponds to the spatial bandwidth $w$. We can further express it by
    \begin{equation}
        \begin{aligned}
            \Delta \bar{g}({r},{\bf r}')& =  \frac{1}{2\pi^2{\rm j}} \int_{C^+} \frac{e^{ {\rm j}w(r-\xi)}}{r-\xi}\frac{e^{{\rm j}k_0(\left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\|)}}{\left\| \boldsymbol{\xi}-{\bf r}' \right\|}{\rm d}\xi 
            \\& ~~~~- \frac{1}{2\pi^2{\rm j}} \int_{C^-} \frac{e^{ -{\rm j}w(r-\xi)}}{r-\xi}\frac{e^{{\rm j}k_0(\left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\|)}}{\left\| \boldsymbol{\xi}-{\bf r}' \right\|}{\rm d}\xi. 
        \end{aligned}
    \end{equation}
    The following part is similar to [13], which shows that when $w>{\rm max}\frac{\partial \left( k_0\left( \left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\| \right) \right)}{\partial \xi}$, $\Delta \bar{g}$ converges to 0 faster than any power. Moreover, when $w<{\rm max}\frac{\partial \left( k_0\left( \left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\| \right) \right)}{\partial \xi}$, $\Delta \bar{g}\approx \bar{g}$. Therefore, $w_0 = {\rm max}\frac{\partial \left( k_0\left( \left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\| \right) \right)}{\partial \xi}$ can be chosen as the spatial bandwidth of the received electromagnetic field. From geometrical analysis, it is easy to find that the maximum of $\frac{\partial \left( k_0\left( \left\| \boldsymbol{\xi}-{\bf r}' \right\|-\left\| \boldsymbol{\xi} \right\| \right) \right)}{\partial \xi}$ only depends on the radius $r_s$ of the scatterer, and the inner structure of the scatterer does not have obvious influence on the DoF. Moreover, we can bound $w_0$ by $\frac{2\pi r_s}{\lambda}<w_0<\sqrt{2}\frac{2\pi r_s}{\lambda}$, where $r_s$ is the radius of the scatterer. The lower bound of $w_0$ is achieved when $\boldsymbol{\hat{\mu}} = \boldsymbol{\hat{\mu}}_0$ satisfies the condition that the corresponding scatterer surface is tangent to $OF$, as shown in Fig. \ref{fig_mu}. When $\boldsymbol{\hat{\mu}} \neq \boldsymbol{\hat{\mu}}_0$, the lower bound of $w_0$ will be less than $\frac{2\pi r_s}{\lambda}$. Specifically, we can obtain 
\begin{equation}
	\begin{aligned}
		w_0&>\frac{2\pi d }{\lambda} 2\sin \frac{\alpha}{2} \cos \frac{\alpha}{2} = \frac{2\pi d \sin \alpha}{\lambda}
		\\& = \frac{2\pi d}{\lambda} \frac{r_s \cos(\alpha_0+\theta)}{\sqrt{(d-r_s\sin(\alpha_0+\theta))^2+(r_s\cos(\alpha_0+\theta))^2}}
		\\& = \frac{2\pi d}{\lambda}\frac{r_s\cos(\alpha_0+\theta)}{\sqrt{d^2+r_s^2-2dr_s\sin(\alpha_0+\theta)}},
	\end{aligned}
\end{equation}
}{\textcolor{red}{
where $\sin(\alpha_0)=\frac{r_s}{d}$ and $\cos(\theta) = \boldsymbol{\hat{\mu}}\cdot\boldsymbol{\hat{\mu}}_0 $.}
}

\begin{figure}[H]
	\centering 
	\includegraphics[width=0.5\textwidth]{figs/dof_consider_mu.pdf} 
	\caption{\color{red}Concerning the spatial bandwidth with respect to different $\boldsymbol{\hat{\mu}}$.} 
	\label{fig_mu}
\end{figure}

{\textcolor{red}{
From the above analysis we know that the spatial bandwidth and channel DoF mainly rely on the outermost layer of the scattering region. To be more specific, smaller $r_s$ leads to smaller scattering regions, which reduces the DoF. When $a$ is smaller than $0$, the scattering region can be viewed as the outermost circle combined with the inner part, and the DoF will not change heavily with $a$. When all the scattering power comes from the outermost circle, which plays the most important role in affecting the DoF, the DoF will be the largest. Therefore, the DoF reaches the maximum when $a$ approaches $-1$. For two-dimensional receiver adopted in this paper, we can decompose the surface in two different directions, each with spatial bandwidth $w_0$.}
}
    
{\color{red}
    \quad Then, we plot the eigenvalues of the correlation matrix when the radius and shape of the scattering region vary in Fig. \ref{fig_eigen_a} and Fig. \ref{fig_eigen_r}. We can observe that the DoF of the channel will increase with the radius $r$ of the scatterer, and decrease when $a$ increases. When $a$ approximates $-1$, which corresponds to the case that the scatterer tends to a ring, the DoF of the channel reaches the maximum, which coinsides with the spatial bandwidth analysis.
    
    \quad Note that the spatial bandwidth analysis is based on the infinitely large observation region of the received electromagnetic fields. For practical scenarios with limited observation region, the observed field can not be strictly band-limited in the wavenumber domain. Moreover, the spatial sampling period should not be equal to that in sampling theorem because the points far away from the scatterer are not as important as the ones close to the scatterer. This problem is discussed in [43] and the tool of cut-set integral is introduced. Results of the approximated DoF considering a closed surface as the receiver that encloses the source are discussed in [43], which we will follow to provide DoF bounds in the scenario with square receiving surface. 
    
    \quad Here we discuss a simple scenario that the line between the center of the scatterer and the center of the receiving surface is vertical to the receiving surface. We construct two spheres concentric with the scatterer region. These spheres satisfy the condition that the receiving surface is inscribed in a circle $C_1$ on the large sphere $S_1$, and its four sides are externally-tangent to a circle $C_2$ on the small sphere $S_2$, as shown in Fig. \ref{fig_circles}. We denote the two spherical caps of $S_1$ divided by $C_1$ as $S'_1$ and $S''_1$, where $S'_1$ is the larger one. Similarly we have $S'_2$ and $S''_2$. Since the information flows through any closed surface that encloses the scatterer should be the same, we know that the electromagnetic fields on $C_1$ and $S''_1$ have the same DoF, so as $C_2$ and $S''_2$. According to [43] we know that the DoF on the sphere $S_1$ and $S_2$ are $N_0 = O(r_s^2/\lambda^2)$.} {\color{red}From symmetry on the sphere\footnote{\color{red}Here the asymmetry introduced by $\hat{\boldsymbol{\mu}}$ is not considered since it is hard to evaluate. By considering this asymmetry a more accurate result will be obtained.} and simple geometry, the DoF $N_1$ on $S''_1$ can be expressed by
    \begin{equation}
        N_1 \approx N_0\frac{\mathcal{A}_{S''_1}}{\mathcal{A}_{S_1}}= N_0\frac{2\pi\sqrt{d^2+r_m^2}(\sqrt{d^2+r_m^2}-d)}{4\pi(d^2+r_m^2)}.
    \end{equation}
    Similarly we know that the DoF $N_1$ on $S''_1$ can be expressed by $N_2 \approx N_0 \frac{2\pi\sqrt{2d^2+r_m^2}(\sqrt{2d^2+r_m^2}-\sqrt{2}d)}{4\pi(2d^2+r_m^2)}$.
    Then we have $N_2\leqslant N_{\rm receiver} \leqslant N_1$. Note that when $d\gg r_m$, both $N_1$ and $N_2$ approximates $O(\frac{r_s^2r_m^2}{\lambda^2d^2})$, which coincides with [44]. On the contrary, if $r_m \gg d$, $N_{\rm receiver} \approx \frac{N_0}{2}$, because it can be viewed as an infinitely-large surface which gets half of the overall electromagnetic waves out of the scatterer. Under this scenario the DoF has little relationship with the distance between the scatterer and the receiver, which coincides with [13]. Here the asymmetry introduced by $\hat{\boldsymbol{\mu}}$ is not considered since it is hard to evaluate. By considering this asymmetry a more accurate result will be obtained.
    }
    
    \begin{figure}[H]
          \centering 
          \includegraphics[width=0.6\textwidth]{figs/circles.pdf} 
          \caption{\color{red}The receiving surface that is inscribed in $C_1$ and externally-tangent to $C_2$, where $C_1$ and $C_2$ are on $S_1$ and $S_2$ separately.} 
          \label{fig_circles}
      \end{figure}
    
    

    \begin{figure}[H]
        \centering 
        \includegraphics[width=0.5\textwidth]{figs/eigen_a.pdf} 
        \caption{The eigenvalues of the correlation matrix in decreasing order with ${\bf d}$ fixed to $[-100,100,-100]\,{\rm m}$, $\boldsymbol{\mu}$ fixed to $[-\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}},-\frac{1}{\sqrt{3}}]$, and $r=5\,{\rm m}$. The concentration parameter $a$ varies.} 
        \label{fig_eigen_a}
    \end{figure}
    \begin{figure}[H]
        \centering 
        \includegraphics[width=0.5\textwidth]{figs/eigen_r.pdf} 
        \caption{The eigenvalues of the correlation matrix in decreasing order with ${\bf d}$ fixed to $[-100,100,-100]\,{\rm m}$, $\boldsymbol{\mu}$ fixed to $[-\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}},-\frac{1}{\sqrt{3}}]$, and $a=0$. The radius $r$ varies.} 
        \label{fig_eigen_r}
    \end{figure}
    
\end{framed}

\textbf{Reviewer 3:}
Finally, the proposed channel estimation algorithm is interesting but, contrary to what is stated, it is not based on the proposed model but only on the consideration that the channel is in the near field and sparse. In fact, nothing from the proposed model is used in the estimator. In fact, it has also been validated using the classical 3GPP CDL model. I would see this section as a contribution to submit in a separate paper.

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable comments. The proposed model is used in the channel estimator to construct an approximate channel correlation function when the sparsity of the channel in the wavenumber domain is obtained. It can be viewed as an improvement method compared to [24], which construct the channel correlation function from isotropic incident waves. We add the explanation about the relationship between the channel estimation scheme and the proposed model. Detailed revisions are shown in the following box: 
}}

\begin{framed}
	{\bf{Section V}}

	\quad After discussing the properties of the analytical channel model, we will propose a near-field channel estimation scheme based on the model. {\textcolor{red}{We first perform Fourier transformation on the observed field to capture the power peaks in the wavenumber domain. Then we use the }{\color{red} proposed model, which provides the prior information of electromagnetic fields, to reconstruct an approximate channel correlation function. This approach is similar to the subspace based channel estimation scheme in [24], which constructs the correlation function based on isotropic scattering field. Compared to [24], our scheme provides more prior information of electromagnetic fields of the fields by using the proposed channel model. Therefore, it can achieve better performance than the existing schemes. }}In the channel estimation procedure, the received field is denoted by ${\bf y}=\sqrt{P}{\bf h}+{\bf n}$, where $P$ is the signal-to-noise ratio, ${\bf h}$ is generated from the channel coupling matrix, and ${\bf n} \sim \mathcal{CN}(0,{\bf I})$ is the noise vector. 
\end{framed}


\textbf{Reviewer 3:}
Minor comments:

After Eqn. (5): What is $\hat{\mu}$?

{\color{blue}{\textbf{Authors: } 
Thanks for the reviewer's valuable comments. Since the scattering region, as assumed in the paper, is a circular surface. It should have a certain direction, which we represent as $\boldsymbol{\hat{\mu}}$. Specifically, it is the direction that is tangent to the scatterer surface.

 Detailed revisions are shown in the following box: 
}}

\begin{framed}
	{\bf{Section III.A}}

	\quad We further assume that the scattering region $V$ is distributed in a solid circle, centering at ${\bf d}$ and perpendicular to $\hat{\boldsymbol{\mu}}$, which means that $\hat{\boldsymbol{\mu}}^{\rm T}({\bf r}'-{\bf d})=0 $. {\color{red}Here $\hat{\boldsymbol{\mu}}$ represents the direction of the scattering surface.}
\end{framed}

{\color{blue}
The meaning of $\boldsymbol{\hat{\mu}}$ is also shown in Fig. 1, as 
\begin{figure}[H]
	\centering 
	\includegraphics[width=0.5\textwidth]{figs/threedimension_solid_circle.pdf} 
	\label{fig_3d_solid_sphere}
\end{figure}
}

\textbf{Reviewer 3:}
The autocorrelation function is initially named $R_E(r_1,r_2)$, then $R(r_1,r_2)$. Please, adopt the same symbol.

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer for pointing out this problem. We have add explanations in the paper, clarifying that we use $R$ instead of $R_E$ for simplicity. Then we replace the rest of the $R_E$ with $R$. Detailed revisions are shown in the following box:
}}

\begin{framed}
	{\bf{Section III.A}}

	\quad By omitting the first item in (\ref{equ_scattering_field}) which represents the deterministic line-of-sight component, we have 
\begin{equation}
	\begin{aligned}
	R_E({\bf r}_1,{\bf r}_2) =& \mathbb{E} \Big[\int_V\int_V g({\bf r}_1,{\bf r}_1')g^{*}({\bf r}_2,{\bf r}_2')(k^2({\bf r}'_1)-k_0^2)
	\\& (k^2({\bf r}'_2)-k_0^2) E({\bf r}_1') E^{*}({\bf r}_2') {\rm d}{\bf r}_1'{\rm d}{\bf r}_2'\Big],
	\end{aligned}
	\tag{8}
	\label{equ_correlation_complicated}
\end{equation}
{\color{red}where in the rest part of the paper we express $R({\bf r}_1,{\bf r}_2)$ as the abbreviation of $R_E({\bf r}_1,{\bf r}_2)$.}
\end{framed}

\textbf{Reviewer 3:}
Eqn. $(16)$: Why is there still $r'$ in the last row if it has been integrated out?

{\color{blue}{\textbf{Authors: } 
Thanks to the reviewer for pointing out this problem. We have fixed this problem by substituting ${\bf r}_0'$ for ${\bf r}'$, where ${\bf r}_0'$ is the position of the center of the scatterer. When $r_s \rightarrow 0$ ($V$ shrinks to the single point at ${\bf r}'_0$), $f({\bf r}') \rightarrow \delta({\bf r}'-{\bf r}'_0)$. Then when we integrate out ${\bf r}'$, we have $R({\bf r}_1,{\bf r}_2) \overset{r_s \rightarrow 0}{\approx} \frac{\beta }{16\pi^2 \| {\bf r}_0-{\bf r}'_0 \|^2} e^{-{\rm j}k \hat{\bf r}'_0 \cdot ({\bf r}_1-{\bf r}_2)}$.

 Detailed revisions are shown in the following box:
}}

\begin{framed}
	{\bf{Section IV.C}}

	\quad  First note that in the scenario with far field approximation the correlation function of the random channel can be simplified to 
	\begin{equation}
		\begin{aligned}
			R({\bf r}_1,{\bf r}_2) &= \beta \int_V \frac{e^{{\rm j}k\| {\bf r}_1-{\bf r}' \|}}{4\pi \|{\bf r}_1-{\bf r}' \|}\frac{e^{-{\rm j}k\| {\bf r}_2-{\bf r}' \|}}{4\pi \|{\bf r}_2-{\bf r}' \|} f({\bf r}'){\rm d}{\bf r}'
			\\& \overset{r_m \rightarrow 0}{\approx} \beta \int_{V} \frac{e^{{\rm j}k \left( r' - \hat{\bf r}'\cdot {\bf r}_1\right)}e^{-{\rm j}k \left( r' - \hat{\bf r}'\cdot {\bf r}_2\right)}}{16\pi^2 \| {\bf r}_0-{\bf r}' \|^2} f({\bf r}'){\rm d}{\bf r}'
			\\& \color{red}{\overset{r_s \rightarrow 0}{\approx} \frac{\beta}{16\pi^2 \| {\bf r}_0-{\bf r}'_0 \|^2} e^{-{\rm j}k \hat{\bf r}'_0 \cdot ({\bf r}_1-{\bf r}_2)},}
		\end{aligned}
		\tag{21}
		\label{equ_far_approx}
	\end{equation}
	where ${\bf r}_0$ is the position of the center of the receiver array, {\color{red}and ${\bf r}'_0$ is the position of the center of the scatterer. The last approximation is based on the fact that for $r_s = \frac{1}{2n}$, where $n\in \mathcal{Z}^+$, $\int_V f({\bf r}'){\rm d}{\bf r}' = 1$. Moreover, when $n\rightarrow +\infty$, $f({\bf r}')=0$ for any ${\bf r}'\neq{\bf r}'_0$. Therefore, $f({\bf r}')$ approaches $\delta({\bf r}'-{\bf r}'_0)$ when $r_s$ approaches 0}.
\end{framed}


{\color{blue}{\textbf{Authors: } 
Many thanks again for your valuable time and efforts to review this paper. 

Sincerely, \\
{\it The Authors }
}}


\clearpage 


\end{document}
